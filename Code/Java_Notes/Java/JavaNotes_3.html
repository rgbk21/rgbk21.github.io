<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
          integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
          crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
          integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
          crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
          integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
          crossorigin="anonymous"></script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-9QJ5D3X353"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-9QJ5D3X353');
  </script>
  <!-- Style for inline code blocks start -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js"></script>
  <!-- Style for inline code blocks end -->
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,300;0,400;0,500;1,400&display=swap" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="../../../globalStyles.css">
  <link rel="stylesheet" type="text/css" href="../../../sidebar.css">
  <meta name="author" content="Raj Gaurav Ballabh Kumar">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Java Notes 3</title>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">

  <div class="navbar-header">
    <a href="../../../index.html" class="navbar-brand"> rgbk21</a>
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"><span
    class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="nav navbar-nav">
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Projects</a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="../../../Projects/TwitterCritNodes/TwitterCritNodes_1.html">Identifying Critical Nodes on Twitter</a>
          <a class="dropdown-item" href="../../../Projects/isRelatedTo/isRelatedTo.html">isRelatedTo</a>
          <div class="dropdown-divider"></div>
        </div>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">HTML Projects</a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="../../../Words/index.html">Words</a>
          <a class="dropdown-item" href="../../../WordleCheater/index.html">Wordle Cheater</a>
          <a class="dropdown-item" href="../../../Pig_Game/index.html">2-Player Pig Game</a>
          <a class="dropdown-item" href="../../../ImageGallery/ImageGallery.html">Image Gallery</a>
          <a class="dropdown-item" href="../../../RGB_Guesser_Game/RGB.html">RGB Guesser Game</a>
          <a class="dropdown-item" href="../../../ToDoList/todo.html">To-Do List</a>
          <div class="dropdown-divider"></div>
        </div>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Notes</a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="../../../Lectures/COMS_631/COMS_631_index.html">COMS 631</a>
          <a class="dropdown-item" href="../../../Lectures/COMS_535/COMS_535_index.html">COMS 535</a>
          <a class="dropdown-item" href="../../../Lectures/EffectiveJava/EffectiveJava.html">Effective Java</a>
          <a class="dropdown-item" href="../../../Lectures/DI/DI.html">Dependency Injection</a>
          <a class="dropdown-item" href="../../../Lectures/Linux/Linux.html">Linux</a>
          <a class="dropdown-item" href="../../../Lectures/Polish/Polish.html">Polish</a>
          <div class="dropdown-divider"></div>
        </div>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Code</a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="../../ThingsToRemember/ThingsToRemember.html">Things To Remember</a>
          <a class="dropdown-item" href="../JavaNotes.html">Java Notes</a>
          <a class="dropdown-item" href="../JavaNotes_2.html">Java Notes 2</a>
          <a class="dropdown-item" href="../../LeetCode/LeetCode.html">LeetCode Notes</a>
          <a class="dropdown-item" href="../../Applying_Java_Notes/ApplyingJava_Notes.html">ApplyingJava Notes</a>
          <a class="dropdown-item" href="../../JavaScript/JavaScript.html">JavaScript Notes</a>
          <a class="dropdown-item" href="../../HTML_CSS/HTML_CSS_Basics.html">HTML & CSS Notes</a>
          <a class="dropdown-item" href="../../SQL/SQL.html">SQL Notes</a>
          <a class="dropdown-item" href="../../Spring/Spring.html">Spring Notes</a>
          <a class="dropdown-item" href="../../Kafka/Kafka.html">Kafka Notes</a>
          <a class="dropdown-item" href="../../Angular/Angular.html">Angular</a>
          <a class="dropdown-item" href="../../Hibernate/Hibernate.html">Hibernate</a>
          <div class="dropdown-divider"></div>
        </div>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">In Another Life</a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="../../../InAnotherLife/Chapter1/Chapter1.html">Chapter 1</a>
          <a class="dropdown-item" href="../../../InAnotherLife/Chapter2/Chapter2.html">Chapter 2</a>
          <a class="dropdown-item" href="../../../InAnotherLife/Chapter3/Chapter3.html">Chapter 3</a>
          <a class="dropdown-item" href="../../../InAnotherLife/Chapter4/Chapter4.html">Chapter 4</a>
          <div class="dropdown-divider"></div>
        </div>
      </li>
    </ul>

    <ul class="navbar-nav ml-auto">
      <li class="nav-item active"><a class="nav-link" href="https://github.com/rgbk21">GitHub</a></li>
      <li class="nav-item active"><a class="nav-link" href="https://www.goodreads.com/user/show/43753334-gaurav-raj/">GoodReads</a></li>
      <li class="nav-item active"><a class="nav-link" href="https://www.instagram.com/wobblyframes/">Instagram</a></li>
      <li class="nav-item active"><a class="nav-link" href="https://www.facebook.com/SomeRandomThoughts">Facebook</a></li>
    </ul>
  </div>
</nav>

<button id="sidebarToggle" class="btn btn-primary d-lg-none">
  <i class="fa fa-list"></i> <!-- Font Awesome bars icon -->
</button>

<!-- Overlay for when the sidebar is open on small screens -->
<div id="sidebarOverlay" class="d-lg-none"></div>

<div class="two-column-layout">
  <div class="index-column">
    <h4>Index</h4>
    <div class="index-entries-container">
      <a class="index-column-entry" href="#Tip1">Tip1: Assertions</a>
      <a class="index-column-entry" href="#Tip2">Tip2: Boolean Parameters</a>
      <a class="index-column-entry" href="#Tip3">Tip3: Builders</a>
      <a class="index-column-entry" href="#Tip4">Tip4: Charsets</a>
      <a class="index-column-entry" href="#Tip5">Tip5: Choosing Collections</a>
      <a class="index-column-entry" href="#Tip6">Tip6: Classes</a>
      <a class="index-column-entry" href="#Tip7">Tip7: Closing Resources</a>
      <a class="index-column-entry" href="#Tip8">Tip8: Code Generation</a>
      <a class="index-column-entry" href="#Tip9">Tip9: Collection Implementations</a>
      <a class="index-column-entry" href="#Tip10">Tip10: Comparison</a>
      <a class="index-column-entry" href="#Tip11">Tip11: Concurrency</a>
      <a class="index-column-entry" href="#Tip12">Tip12: Conditional Failures</a>
      <a class="index-column-entry" href="#Tip13">Tip13: Constants</a>
      <a class="index-column-entry" href="#Tip14">Tip14: Constructors</a>
      <a class="index-column-entry" href="#Tip15">Tip15: Dates and Times</a>
      <a class="index-column-entry" href="#Tip15.1">Tip15.1: JavaTime</a>
      <a class="index-column-entry" href="#Tip16">Tip16: Dependency Injection</a>
      <a class="index-column-entry" href="#Tip17">Tip17: Enums</a>
      <a class="index-column-entry" href="#Tip18">Tip18: Equals</a>
      <a class="index-column-entry" href="#Tip19">Tip19: Exceptions</a>
    </div>
  </div>
  <div class="content-column">
    <div class="container">

      <button id='load-all-gists' type="button" class="btn btn-outline-primary">Show all Gists!</button>

      <div>
        This page contains <br>
        a) Java: <br>
      </div>


      <div class="sub-heading">Useful Links</div>
      <div>
        - <a href="https://google.github.io/styleguide/javaguide.html">Google Java Style Guide</a>. <br>
        - <a href="https://guava.dev/releases/snapshot-jre/api/docs/index.html">Guava API Docs</a>, <a
        href="https://github.com/google/guava/tree/master/guava/src/com/google/common">Github</a>, <a
        href="https://www.javadoc.io/doc/com.google.guava/guava-testlib/latest/com/google/common/testing/package-summary.html">Guava Testing Utilities Docs</a>. <br>
        - <a href="https://docs.oracle.com/en/java/javase/21/core/toc.htm">Oracle: Java 21 Core Libraries</a>. <br>
        - <a href="https://www.oracle.com/java/technologies/javase/seccodeguide.html">Oracle: Secure coding guidelines for Java SE</a>.

      </div>

      <hr>
      <div id="Tip1" class="chapter">Tip 1: Assertions</div>
      <hr>

      <div class="textual-content">
        - Assertions vs Conditional Failures vs Verification Checks. <br>
        - An assertion is a check that will always pass unless the class making the assertion is badly broken. Assertions are mostly useful while you are actively modifying the
        code, but by the time development settles down, you should be essentially 100% sure it will never fail. This means that there is no value in actually performing the check
        in prod. It is a waste of resources.
      </div>

      <hr>
      <div id="Tip2" class="chapter">Tip 2: Boolean Parameters</div>
      <hr>

      <div class="textual-content">
        - Avoid using boolean params in public methods where feasible. Consider the following alternatives:
        <br>
        <br>
        a) Use two uniquely named methods: <br>
        - If the parameter is used to change some aspect of the method's behavior, consider providing two differently-named methods instead. A common prefix is probably a good
        idea.
        For example, see
        <a href="https://github.com/google/guava/blob/47b7e9e5ef3f2267f8ac327d68cc56b99e186aa8/guava/src/com/google/common/collect/Iterators.java#L602">partition</a>
        and <a href="https://github.com/google/guava/blob/47b7e9e5ef3f2267f8ac327d68cc56b99e186aa8/guava/src/com/google/common/collect/Iterators.java#L621">paddedPartition</a>
        methods in <a href="https://github.com/google/guava/blob/master/guava/src/com/google/common/collect/Iterators.java">Iterators</a>. This makes it easy to count the usages of
        two methods separately. <br>
        - Different behaviors call for different methods. Ofc, these methods can still be implemented by passing a <code>boolean</code> to a <code>private</code> helper. <br>
        - If this is a constructor, you can't exactly split it into differently-named constructors. But you can switch to factory methods, as recommended in <a
        href="../../../Lectures/EffectiveJava/EffectiveJava.html#Item#1">Item1</a>. <br>
        - This change may result in some callers having to write code such as <code>condition() ? foo.methodA() : foo.methodB()</code>. If it's many callers, you may need to
        reevaluate. In such cases prefer alternatives below. <br>
        - The same advice also holds for methods that use null or a special magic vlaue to trigger an alternative behavior. Provide for that behavior explicitly with its own
        methodd
        atleast.

        <br>
        <br>

        b) Replace with a two-element enum. <br>
        - When the above advice doesn't apply, or just doesn't make sense in your particular case, consider replacing the boolean with a two-element enum type as advised in
        Effective
        Java (Prefer two-element enum types to boolean parameters).

        <br>
        <br>

        c) Define an enum with one constant for each boolean parameter. <br>
        - See <a href="https://docs.oracle.com/javase/8/docs/api/java/nio/file/Files.html#newInputStream-java.nio.file.Path-java.nio.file.OpenOption...-">Files.newInputStream</a>
        which lets caller pass args like <a href="https://docs.oracle.com/javase/8/docs/api/java/nio/file/StandardOpenOption.html">APPEND, CREATE</a>... etc instead of true/false
        values.

        <br>
        <br>

        d) Wrap with a value type. <br>
        - If the number of params is getting large, say more than two, you can introduce a value type, for example a <code>Record</code>, that holds these args which provides type
        safety and improves readability without needing to introduce separate methods/types for each argument.

        <br>
        <br>

        e) When calling boolean parameter method, consider argument comments. <br>
        - <code>booleanMethod(/* enableFoo = */ true);</code>
      </div>

      <hr>
      <div id="Tip3" class="chapter">Tip 3: Builders</div>
      <hr>

      <div class="textual-content">
        <p class="inline-heading">What is a Builder?</p> <br>
        - Builders are mutable objects whose sole purpose is to collect data and then use that data to construct (typically immutable and longer-lived) instance of the related
        type.
        <br>
        - <code>Song song = Song.builder().setArtist("TS").setTitle("Up in Flames").build()</code>. In this example, the builder class <code>Song.Builder</code> is never referenced
        explicitly. <br>
        - Builders are typically very short-lived, used within a single method or related private methods. Chaining the method calls as shown above is generally preferred when
        possible, which is not only more concise, but also allows the temporary builder instance to be immediately forgotten, having never even been stored in a local variable.
        Note
        how also we are using <a href="https://en.wikipedia.org/wiki/Fluent_interface#Java">fluent API</a>.

        <br>

        <p class="inline-heading">When should I use a Builder?</p> <br>
        - The main alternative to a builder is a factory method (or a public constructor, but those are somewhat <a
        href="../../../Lectures/EffectiveJava/EffectiveJava.html#Item#1">discouraged</a>).
        Use a buiider if: <br>
        a) when some params are meant to be optional (perhaps having default values) <br>
        b) when there are "many" params <br>
        c) when several params are of the same type, eg firstName, lastName <br>
        See <a href="../../../Lectures/EffectiveJava/EffectiveJava.html#Item#2">Item#2</a> for more info.

        <br>

        <p class="inline-heading">What should my Builder look like?</p> <br>
        a) Built objects should be deeply immutable. If they aren't, it is imperative that the builder and the built object each have their own completely
        separate state. <br>
        - Deep immutability means that not only is the object itself immutable, but any objects it contains are also immutable, all the way down. <br>
        - For instance, this is an example of Builder:
        <div class="code-block">
          <div class="expand-code-snip-btn border border-primary rounded">
            <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
          </div>
          <div class="code-snippet">
            <script src="https://gist.github.com/rgbk21/20d356a390a1a2c5fe8bdb6262c27544.js"></script>
          </div>
        </div>

        - However, sometimes you can't make an object deeply immutable, like a list or another object that is inherently mutable, like <code>java.util.date</code>. This is where
        the second part of the rule is critical: "...it is imperative that the builder and the built object each have their own completely separate state." This means that when you
        call the build() method, the builder must not share its internal data with the object it creates. If it does, changes to the builder after an object has been built could
        accidentally change the already-built object. This is a major source of bugs. The solution is to make defensive copies of any mutable data. Refer the below example:
        <div class="code-block">
          <div class="expand-code-snip-btn border border-primary rounded">
            <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
          </div>
          <div class="code-snippet">
            <script src="https://gist.github.com/rgbk21/cea2484f3d77701bdaa65b1b3453c113.js"></script>
          </div>
        </div>

        b) If possible, you should nest the builder type inside of your type (eg. Song.Builder). Your type should provide a <code>public static builder()</code> to instantiate a
        new
        builder instance. <br>
        - If you are unable to nest the buiider type, the builder should be a top-level type with a descriptive name. You might have to resort to this if you are creating a buiider
        for a class you cannot modify, eg, it's from a third-party library and is <code>final</code>. <br>

        c) The builder type may be either an interface or a static class. <br>
        d) The <code>build()</code> method should have no params. <br>
        e) Any validation that can be done on individual property values should <i>ideally</i> happen immediately in the setter for that value (throwing an <code>IllegalArgumentException</code>)
        or during <code>build()</code>. <br>

        - Using Builders with inheritance is tricky. <a href="https://eamonnmcmanus.blogspot.com/2020/10/using-builder-pattern-with-subclasses.html">Eamonn Mcmanus</a> blog.

      </div>

      <hr>
      <div id="Tip4" class="chapter">Tip 4: Charsets</div>
      <hr>

      <div class="textual-content">

        - This section describes the best practices when working with <a
        href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/nio/charset/Charset.html">Charset</a>
        class.

        <br>
        <br>

        <div class="sub-heading">Introduction: Characters and Bytes</div>
        - Conceptually, we think of strings in programs as sequences of <i>characters</i> - individual written marks in a language. Like "a" or "A" or &#x1F60A. However, these
        character sequences are actually sequences of bytes. So it comes down to how sequences of bytes map to an abstract idea of characters. For instance, we decide that the
        character "a" will be mapped to the byte "0x61". This is known as <i>character encoding</i>. <br>
        - Java follows the <a href="https://www.unicode.org/standard/WhatIsUnicode.html">Unicode Standard</a>. Unicode aims to define one <i>global</i> character set of all of the
        world's major languages, so that people can use software effectively no matter what language they use. But before we do that we get to go through... definitions! <br>

        <p class="inline-heading">Abstract Characters</p>: Unicode's term for the smallest meaningful component of a written language. When it comes to the problem of
        <i>character encoding</i>, these are the basic values being encoded. <br>
        - It is important to keep in mind that an individual abstract character might have multiple possible <i>visual representation</i>, or <i>glyphs</i>. Abstract characters
        refer
        to the character themselves, independent of a particular visual representation. In addition, a single glyph may represent multiple characters. Explained in english, what
        this
        means is that: A single abstract character can be drawn in many different ways. The font you are using determines which "glyph" is shown. For example, the abstract
        character
        "lowercase g" can have different glyphs. Even though they look different, they all represent the same underlying character. The concept of single glyph representing
        multiple characters is: This often happens with ligatures, where two or more characters are combined into a single, flowing glyph for better readability or style. For
        example, the two characters f and i can be combined into a single glyph: Ô¨Å. Each of these characters has a distinct name that identifies it. Considered together, the
        abstract
        characters of a written language form a ... <br>

        <p class="inline-heading">Character Set</p>: A set of one or more abstract characters that make up some written language to be encoded in a program. These are also known as
        <i>Abstract Character Repertories</i>. A <i>Coded Character Set</i> (CCS) is a mapping from the characters in an abstract character set into a... <br>

        <p class="inline-heading">Codespace</p>: A range of numeric values, usually non-negative integers, that can represent abstract characters under a given encoding. <br>

        <p class="inline-heading">Code Point</p>: A single numeric value in a given codespace. Code points are NOT necessarily mapped one-to-one to graphic characters. They can
        serve
        other purposes too. For example, some code points are reserved for internal use by algorithms that perform encoding tasks. Code points form the basis for encoding
        characters
        in a given encoding scheme. <br>
        - The unicode codespace ranges over the integers 0x0 to 0x10FFFF. At least 21 bits are needed to represent any value in this range in binary. <br>
        - Low-level code that deals with characters one at a time may operate on code point integers, and they are typically used to access character properties like "is white
        space"
        or "is letter" or "get digit value". However, for storing <i>strings</i> in a program, we need... <br>

        <p class="inline-heading">Code Units</p>: Code units are the basic building blocks actually used in a computer to represent code points in strings. Code units are stored in
        unsigned integers that are 8, 16, or 32 bits wide. Each <i>code point</i> maps to 1-4 <i>code units</i> according to a... <br>

        <p class="inline-heading">Character Encoding Format (CEF)</p>: <br>
        - A mapping from the code points in a codespace to code unit sequences that can be handled by software. <br>
        - As you can see in the below example, code points are mapped to <i>sequences of code units</i> - and it is normal for a code point to map to more than one code unit. In
        many cases, looking at code units individually is meaningless.

        <div class="image-block">
          <div class="expand-screenshot-image-btn border border-primary rounded">
            <span class="btn btn-link">Show Image <img src="../imgs/chevron-expand.svg" alt="Show Image Button"></span>
          </div>
          <div class="screenshot-image">
            <img src="./imgs/Unicode.jpg"
                 width="1200"
                 class="center-block img-fluid"
                 alt="Example1"
                 loading="lazy">
          </div>
        </div>

        <div class="sub-section">
          - Question: Something like the üòä "Smiling face with smiling eyes" in UTF-8 would be mapped to the byte sequence: <code>0xF0 0x9F 0x98 0x8A</code>. So if we reverse the
          direction of the conversion, that is going from the byte value to the actual abstract character being represented, how doe the code know to consider all the four bytes
          together? Why doesn't it convert it into, for example, four individual glyphs with code points 0xF0, 0x9F, 0x98, and 0x8A? <br>
          Answer: The answer lies in the clever, self-synchronizing design of UTF-8. A UTF-8 decoder knows how many bytes to read for a single character by looking at the bit
          pattern
          of the <i>first byte</i>. <br>
          <br>
          Here are the rules:
          <ul>
            <li>If the first byte starts with <code>0</code>, it's a single-byte character (this covers all of standard ASCII). <br>
              Pattern: <code>0xxxxxxx</code>
            </li>
            <li>If the first byte starts with <code>110</code>, it's the start of a two-byte character. <br>
              Pattern: <code>110xxxxx 10xxxxxx</code>
            </li>
            <li>If the first byte starts with <code>1110</code>, it's the start of a three-byte character. <br>
              Pattern: <code>1110xxxx 10xxxxxx 10xxxxxx</code>
            </li>
            <li>If the first byte starts with <code>11110</code>, it's the start of a four-byte character. <br>
              Pattern: <code>11110xxx 10xxxxxx 10xxxxxx 10xxxxxx</code>
            </li>
          </ul>
          Any byte that starts with <code>10</code> is called a <i>continuation byte</i>. It can <i>only</i> appear after a starting byte; it can never be the beginning of a
          character
          on its own. <br>

          Let's apply this to your example, the emoji üòä (<code>U+1F60A</code>), which is <code>0xF0 0x9F 0x98 0x8A</code> in UTF-8: <br>
          1. The decoder reads the first byte: <code>0xF0</code>. In binary, this is <code>11110000</code>. <br>
          2. It sees the <code>11110...</code> pattern and immediately knows: "This is the start of a <i>4-byte</i> character. I must read the next <i>3</i> bytes to complete it."
          <br>
          3. It reads the next three bytes: <code>0x9F</code> (<code>10011111</code>), <code>0x98</code> (<code>10011000</code>), and <code>0x8A</code> (<code>10001010</code>).
          <br>
          4. It confirms that all three of these start with the <code>10...</code> pattern, verifying they are valid continuation bytes. <br>
          5. The decoder then combines the data bits (the <code>x</code>'s) from all four bytes to reconstruct the original Unicode code point <code>U+1F60A</code>, which it then
          maps
          to the "Smiling face with smiling eyes" character. <br>
          This is why it doesn't see four separate characters. The bytes <code>0x9F</code>, <code>0x98</code>, and <code>0x8A</code> are invalid as starting bytes, so the decoder
          knows
          they are just parts of the character that began with <code>0xF0</code>.
        </div>

        <div class="sub-heading">What does all of this mean for Java?</div>
        - Java uses the UTF-16 encoding form for all text processing. The <code>char</code> type for <i>code units</i>. This means that java internally represents text using
        UTF-16.
        This means that APIs that operate on the <code>char</code> level do not necessarily operate on complete Unicode characters. A given <code>char</code> value may only be one
        portion of a code point. Operating directly on <code>char</code>s should typically be reserved for cases in which you know it is safe to do so (specifically, cases in which
        you <i>know</i> that you are only dealing with characters that consist of a single code unit under UTF-16)

        <div class="code-block">
          <div class="expand-code-snip-btn border border-primary rounded">
            <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
          </div>
          <div class="code-snippet">
            <script src="https://gist.github.com/rgbk21/49db0952f084fd3c9b4ba932c50af2d0.js"></script>
          </div>
        </div>

        So the points that you need to remember are: <br>
        a) Don't trust <code>String.length()</code>. It tells you the number of 16-bit <code>char</code> units, not the number of visual characters. <br>
        b) Avoid <code>charAt(i)</code> loops. Iterating over a string with a simple for loop from 0 to length() - 1 is fragile. It will break and misinterpret any string
        containing
        emojis or other supplementary characters. <br>
        c) Use Code Point-Aware Methods: For any operation that needs to handle individual characters (like reversing a string, counting characters, or splitting a string), you
        should use methods that understand code points. The <code>String.codePoints()</code> stream (available since Java 8) is the best and most modern way to do this. <br>

        The below diagram shows the comparison between UTF8 and UTF 16.
        <div class="image-block">
          <div class="expand-screenshot-image-btn border border-primary rounded">
            <span class="btn btn-link">Show Image <img src="../imgs/chevron-expand.svg" alt="Show Image Button"></span>
          </div>
          <div class="screenshot-image">
            <img src="./imgs/utf8_vs_utf16_comparison.png"
                 width="1000"
                 class="center-block img-fluid"
                 alt="Example1"
                 loading="lazy">
          </div>
        </div>


        <div class="sub-heading">How does this all fit in when trying to read from a file or write to a file?</div>
        - A <code>Charset</code> is the crucial bridge that connects that internal world to the external world of files, network streams, and databases.

        <br>
        <br>

        What is a <code>Charset</code>? <br>
        In simple terms, a Charset is a rulebook for converting between characters and bytes. <br>
        Encoder: When you write a Java String to a file, the Charset's encoder is used. It takes the sequence of 16-bit chars (which are internally UTF-16) and converts them into a
        sequence of 8-bit bytes according to its rules (e.g., UTF-8, ISO-8859-1,
        etc.). <br>
        Decoder: When you read a file into a Java String, the Charset's decoder is used. It reads the sequence of bytes from the file and interprets them to reconstruct the
        sequence
        of chars that form the String. <br>

        <p class="inline-heading">The Critical Mistake to Avoid: The "Platform Default"</p> <br>
        - If you use a Java API for reading or writing files that does not ask for a Charset, it will use the platform default charset. This is a major source of bugs. <br>
        - A program running on a Mac or Linux machine will likely default to UTF-8. <br>
        - The same program running on an older Windows machine in the US might default to windows-1252. If you write a file containing ‚ÄúI cost ‚Ç¨5‚Äù on the Windows machine and then
        try
        to read it on the Mac, the ‚Ç¨ symbol will be corrupted because the bytes representing it in windows-1252 are meaningless when interpreted as UTF-8. <br>
        The rule is simple: Always explicitly specify the <code>Charset</code> when converting between characters and bytes. <br>

        <p class="inline-heading">How to Use Charset for File I/O (The Right Way)</p> <br>
        - The modern <code>java.nio.file.Files</code> API makes this easy and is the recommended approach. The best practice is to use the predefined constants in
        <code>java.nio.charset.StandardCharsets</code>. <code>StandardCharsets.UTF_8</code> is almost always the right choice for interoperability. <br>

        <p class="inline-heading">Writing a String to a File</p>: <br>
        - This example takes a <code>String</code> and writes it to a file, explicitly encoding it as UTF-8.
        <div class="code-block">
          <div class="expand-code-snip-btn border border-primary rounded">
            <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
          </div>
          <div class="code-snippet">
            <script src="https://gist.github.com/rgbk21/6cc2935ba975d1be710171fdfcfaee6b.js"></script>
          </div>
        </div>

        <p class="inline-heading">Reading a String from a File</p>: <br>
        - This example reads the bytes from the file we just created and correctly decodes them back into a <code>String</code> because we specify the same <code>Charset</code>.
        <div class="code-block">
          <div class="expand-code-snip-btn border border-primary rounded">
            <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
          </div>
          <div class="code-snippet">
            <script src="https://gist.github.com/rgbk21/15ab5098ad5daa845e006a94f16ee45a.js"></script>
          </div>
        </div>


        <div class="sub-section">
          Question: How does specifying the charset fix this problem? For instance, if I was running the program on the windows-1252 example provided above, wouldn't the bytes when
          writing to the text file be interpreted as that format? Or is the OS going to say that, ok, you provided this specific charset of UTF8, so I am going to make sure to
          store
          the bytes as that. And then what happens when the user opens the text file through a UI interface, like notepad or something? Does the user see the actual text that was
          stored? Or gibberish?

          <br>
          <br>

          Answer:
          <br>
          <br>
          <p class="inline-heading">The Roles of the Java Program and the Operating System</p> <br>

          It's helpful to think of the Java program and the Operating System (OS) as having two very distinct jobs: <br>
          1) The Java Program's Job (The "Translator"): <br>
          - When you write a <code>String</code> to a file, your Java code is responsible for translating its internal character representation (UTF-16) into a sequence of raw
          bytes.
          The <code>Charset</code> you provide is the rulebook for this translation. <br>
          2) The OS's Job (The "Courier"): <br>
          The OS file system is like a courier. It doesn't know or care what the bytes mean. Its only job is to take the exact sequence of bytes your Java program gives it and
          write them to the disk. <br>

          <p class="inline-heading">How Specifying a Charset Fixes the Problem</p> <br>
          - Let's use your example of writing the character ‚Ç¨ on a Windows machine that defaults to windows-1252. <br>
          Scenario 1: You DON'T specify a charset (The WRONG way): <br>
          1. Your Java code has the string "‚Ç¨". <br>
          2. You use an old API like <code>new FileWriter("file.txt")</code> which uses the platform default. <br>
          3. The JVM sees it's on Windows and uses the windows-1252 charset encoder. <br>
          4. The windows-1252 rulebook says the character ‚Ç¨ translates to the single byte 0x80. <br>
          5. Java hands the byte 0x80 to the OS. <br>
          6. The OS writes the single byte 0x80 into the file on the disk. <br>
          The file is now fundamentally a windows-1252 file. It will only be read correctly by programs that know to use the windows-1252 rulebook. <br>

          <br>

          Scenario 2: You DO specify <code>StandardCharsets.UTF_8</code> (The RIGHT way) <br>
          1. Your Java code has the string "‚Ç¨". <br>
          2. You use the modern API: <code>Files.write(path, lines, StandardCharsets.UTF_8)</code>. <br>
          3. You have explicitly told Java: "Ignore the OS default. Use the UTF-8 rulebook." <br>
          4. The UTF-8 rulebook says the character ‚Ç¨ translates to the three-byte sequence 0xE2 0x82 0xAC. <br>
          5. Java hands the three bytes E2, 82, AC to the OS. <br>
          6. The OS writes those exact three bytes into the file on the disk. <br>

          By specifying the charset, you have taken control. You've ensured that no matter where your program runs‚ÄîWindows, Mac, Linux‚Äîit will always produce a file with the exact
          same bytes for the same content. You've created a portable, predictable file. <br>

          <p class="inline-heading">What Happens When a User Opens the File in Notepad?</p> <br>
          This is the crucial second half of the equation. Now, the text editor (like Notepad) has to play the role of the decoder. It reads the raw bytes from the file and must
          guess which rulebook (charset) to use to turn them back into visible characters. <br>
          Scenario 1: If you wrote the file using UTF-8 (containing bytes E2 82 AC): <br>
          On Modern Notepad (Windows 10/11): These versions are much smarter. They often default to or can auto-detect UTF-8. They will read the three bytes, apply the UTF-8 rules,
          and correctly display ‚Ç¨. The user sees the correct text. <br>
          On Old Notepad (or a misconfigured editor): An older editor might blindly assume the system's default windows-1252. It would read the first byte 0xE2 and display √¢. Then
          it would read 0x82 and display ‚Äö. Then 0xAC and display ¬¨. The user sees gibberish: √¢‚Äö¬¨. <br>
          Scenario 2: If you wrote the file using the windows-1252 default (containing byte 0x80): <br>
          On the same Windows PC: The user opens it in Notepad. Notepad assumes the default windows-1252, reads the byte 0x80, and correctly displays ‚Ç¨. It works perfectly...
          locally.
          <br>
          On a Mac or Linux PC: The user opens the file. The text editor on that machine defaults to UTF-8. It reads the byte 0x80. In the UTF-8 rulebook, a byte starting with
          10... (like 0x80) is invalid as the <i>start</i> of a character. The editor knows the data is corrupt and will likely display a replacement character like ``. The user
          sees gibberish. <br>

          <p class="inline-heading">Conclusion</p>: <br>
          - By specifying StandardCharsets.UTF_8 in your Java code, you are choosing to create files in the most universal, widely-supported
          format. You are betting that most modern software (text editors, web browsers, other programs) that reads your file will correctly guess or default to UTF-8, leading to
          the
          highest probability that your text will be displayed correctly for everyone, everywhere. You are fixing the problem by enforcing a consistent, portable standard at the
          point of file creation.
        </div>
      </div>

      <hr>
      <div id="Tip5" class="chapter">Tip 5: Choosing Collections</div>
      <hr>

      <div class="textual-content">

        - Points to consider when choosing which collection type and implementation to use. <br>
        <p class="inline-heading">Prefer immutable collections</p>: <br>
        - <a href="https://github.com/google/guava/wiki/ImmutableCollectionsExplained">Why use immutable collections</a> on github. <br>

        <p class="inline-heading">Understand deterministic vs. non-deterministic iteration</p> <br>
        - Some popular hash-based collections such as <code>HashMap</code> and <code>HashSet</code> have non-deterministic iteration order. These collections iterate in a different
        randomly-seeded order per VM invocation (in tests) and per JDK release. <br>
        - If no one ever iterates over the collection, only performing mutations and map lookups on it, then there's no harm in using these collections. But if the collections
        may be iterated over, the randomization policy can easily lead to flaky tests and sudden behavior changes in production. <br>
        - Fortunately, if you use the immutable collections, this is a non-issue. They all have deterministic iteration. As for mutable types, most such classes (with the exception
        of <code>ConcurrentHashMap</code>) have a deterministic cousin, expressed through the interface of <code>SequencedCollection&lt;E&gt;</code>,
        <code>SequencedSet&lt;E&gt;</code> and <code>SequencedMap&lt;K, V&gt;</code>. Examples include <code>LinkedHashMap</code> and <code>LinkedHashSet</code>. These are a safer
        bet, but at the cost of added memory consumption. <code>TreeMap</code> and <code>TreeSet</code> may be worth considering as well. <br>

        <p class="inline-heading">Choosing a collection sub-interface</p>: Set, List, etc.<br>
        - Choosing the most logically appropriate collection sub-interface type mostly depends on your answers to two basic questions. <br>
        1) Question 1: Duplicates - Does it matter how many occurrences of the same element are present in the collection? Or does it only matter whether the element is contained
        or not (so duplicates should just be collapsed)? <br>
        2) Question 2: Ordering - There are 3 choices for how to treat the ordering of your elements. <br>
        a) Comparator-imposed ordering: Should elements always appear in the order determined by a comparator (which might be their natural order)? <br>
        b) Ordered (order-dependent equality): Should two collections containing the same elements but in a different order be considered <i>different</i> collections? Note that
        order-dependent equality always implies deterministic iteration. <br>
        c) Unordered (order-independent equality): Or should order not matter? This should still use deterministic iteration, it's just that we don't care the order specifically.
        <br>

        Once you have those answers, just find their intersection below: <br>
        <table class="table table-bordered table-sm">
          <thead>
          <tr>
            <th>Order</th>
            <th>Keep Duplicates</th>
            <th>Collapse Duplicates</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td>ordered</td>
            <td><a href=https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html"">List</a></td>
            <td> -</td>
          </tr>
          <tr>
            <td>unordered</td>
            <td><a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/Multiset.html">Multiset</a></td>
            <td><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/Set.html">Set</a></td>
          </tr>
          <tr>
            <td>comparator-imposed</td>
            <td><a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/SortedMultiset.html">SortedMultiset</a></td>
            <td><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/NavigableSet.html">NavigableSet</a></td>
          </tr>
          </tbody>
        </table>

        <p class="inline-heading">Simpler types to consider</p>
        <table class="table table-bordered table-sm">
          <thead>
          <tr>
            <th>If you have...</th>
            <th>and...</th>
            <th>You might want to consider...</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td><code>Iterable&lt;Pair&lt;Foo, Bar&gt;&gt;</code></td>
            <td>The same <code>Foo</code> won‚Äôt appear in multiple pairs</td>
            <td>
              <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html" target="_blank">
                Map&lt;Foo, Bar&gt;
              </a>
            </td>
          </tr>
          <tr>
            <td><code>Iterable&lt;Pair&lt;Foo, Bar&gt;&gt;</code></td>
            <td>The same <code>Foo</code> might appear in multiple pairs</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/Multimap.html" target="_blank">Multimap&lt;Foo, Bar&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>List&lt;Pair&lt;Foo, Bar&gt;&gt;</code></td>
            <td>The same <code>Foo</code> might appear in multiple pairs</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ListMultimap.html" target="_blank">ListMultimap&lt;Foo, Bar&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>Set&lt;Pair&lt;Foo, Bar&gt;&gt;</code></td>
            <td>The same <code>Foo</code> might appear in multiple pairs</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/SetMultimap.html" target="_blank">SetMultimap&lt;Foo, Bar&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>Pair&lt;List&lt;Foo&gt;, List&lt;Bar&gt;&gt;</code></td>
            <td>The lists are the same size, and there is some relationship between elements at the same index</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ListMultimap.html" target="_blank">ListMultimap&lt;Foo, Bar&gt;</a>
              or
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/SetMultimap.html" target="_blank">SetMultimap&lt;Foo, Bar&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>Iterable&lt;Foo&gt;</code></td>
            <td><code>Foo</code> is <code>Comparable</code>, and the values are always contiguous with no gaps (e.g., {5, 6, 7, 8})</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ContiguousSet.html" target="_blank">ContiguousSet&lt;Foo&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>List&lt;Foo&gt;</code> and <code>Set&lt;Foo&gt;</code></td>
            <td>You keep identical contents in both, using one to maintain order and the other to de-duplicate</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ImmutableSet.html" target="_blank">ImmutableSet&lt;Foo&gt;</a> (with
              <code>asList()</code> view), or <code>UniqueList&lt;Foo&gt;</code> that rejects duplicate elements and can therefore be viewed as a set.
            </td>
          </tr>
          <tr>
            <td><code>Iterable&lt;Range&lt;Foo&gt;&gt;</code></td>
            <td>The ranges are disjoint (or should be coalesced, making them disjoint)</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/RangeSet.html" target="_blank">RangeSet&lt;Foo&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>Iterable&lt;Pair&lt;Range&lt;Foo&gt;, Bar&gt;&gt;</code></td>
            <td>The ranges are disjoint</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/RangeMap.html" target="_blank">RangeMap&lt;Foo, Bar&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>Iterable&lt;? extends Number&gt;</code></td>
            <td>You don‚Äôt need it to be mutable</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/primitives/ImmutableIntArray.html" target="_blank">ImmutableIntArray</a> and friends
            </td>
          </tr>
          </tbody>
        </table>

        <table class="table table-bordered table-sm">
          <thead>
          <tr>
            <th>If you have...</th>
            <th>and...</th>
            <th>You might want to consider...</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td><code>Map&lt;Key, Boolean&gt;</code></td>
            <td>You don‚Äôt absolutely need to distinguish between <code>false</code>, <code>null</code> and/or "not present"</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/Sets.html" target="_blank">Set&lt;Key&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>Map&lt;Key, Integer&gt;</code> or <code>Map&lt;Key, Long&gt;</code></td>
            <td>You are doing arithmetic on the values (for example, retrieve a value, add 1, store it back)</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/Multiset.html" target="_blank">Multiset&lt;Key&gt;</a> or
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/util/concurrent/AtomicLongMap.html" target="_blank">AtomicLongMap&lt;Key&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>Map&lt;Enum, Integer&gt;</code></td>
            <td>You are doing arithmetic on the values (for example, retrieve a value, add 1, store it back)</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/EnumMultiset.html" target="_blank">EnumMultiset&lt;Enum&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>Map&lt;Key, NumericValue&gt;</code></td>
            <td><code>NumericValue</code> is some other conceptually numeric type (such as <code>Double</code>) and you are doing arithmetic on the values</td>
            <td>NumericValueMap&lt;Key, NumericValue&gt;</td>
          </tr>
          <tr>
            <td><code>Map&lt;Foo, List&lt;Bar&gt;&gt;</code></td>
            <td>You don‚Äôt absolutely need to distinguish empty list from "not present"</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ListMultimap.html" target="_blank">ListMultimap&lt;Foo, Bar&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>Map&lt;Foo, Set&lt;Bar&gt;&gt;</code></td>
            <td>You don‚Äôt absolutely need to distinguish empty set from "not present"</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/SetMultimap.html" target="_blank">SetMultimap&lt;Foo, Bar&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>Map&lt;Foo, Map&lt;Bar, Qux&gt;&gt;</code></td>
            <td>You don‚Äôt absolutely need to distinguish empty map from "not present"</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/Table.html" target="_blank">Table&lt;Foo, Bar, Qux&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>Map&lt;Pair&lt;Foo, Bar&gt;, Qux&gt;</code></td>
            <td>You wouldn‚Äôt benefit from defining a nested type for the <code>Pair</code></td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/Table.html" target="_blank">Table&lt;Foo, Bar, Qux&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>Multimap&lt;Foo, Pair&lt;Bar, Qux&gt;&gt;</code></td>
            <td>The same <code>Bar</code> won‚Äôt appear in multiple pairs for the same <code>Foo</code></td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/Table.html" target="_blank">Table&lt;Foo, Bar, Qux&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>Map&lt;Foo, Bar&gt;</code> and <code>Map&lt;Bar, Foo&gt;</code></td>
            <td>The same entry is always stored in both maps (once in each order)</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/BiMap.html" target="_blank">BiMap&lt;Foo, Bar&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>Map&lt;Foo, Bar&gt;</code></td>
            <td>Adjacent <code>Foo</code> values often share the same value</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/RangeMap.html" target="_blank">RangeMap&lt;Foo, Bar&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>Map&lt;Key, AtomicInteger&gt;</code></td>
            <td>You are using the <code>AtomicInteger</code> only as a "mutable int" and values are always positive and less than 2^31</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/Multiset.html" target="_blank">Multiset&lt;Key&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>Map&lt;Key, AtomicInteger&gt;</code></td>
            <td>You do not need a reference to an <code>AtomicInteger</code>, only int values that are always positive and less than 2^31</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ConcurrentHashMultiset.html" target="_blank">ConcurrentHashMultiset&lt;Key&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>Map&lt;Key, AtomicLong&gt;</code></td>
            <td>You do not need a reference to an <code>AtomicLong</code>, only long values</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/util/concurrent/AtomicLongMap.html" target="_blank">AtomicLongMap&lt;Key&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>AtomicLongMap</code></td>
            <td>Your values are always positive and less than 2^31</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ConcurrentHashMultiset.html" target="_blank">ConcurrentHashMultiset&lt;Key&gt;</a>
            </td>
          </tr>
          </tbody>
        </table>

        <table class="table table-bordered table-sm">
          <thead>
          <tr>
            <th>If you have...</th>
            <th>and...</th>
            <th>You might want to consider...</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td><code>int[]</code>, <code>long[]</code>, or <code>double[]</code></td>
            <td>You don‚Äôt need it to be mutable</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/primitives/ImmutableIntArray.html" target="_blank">ImmutableIntArray</a> and friends
            </td>
          </tr>
          <tr>
            <td><code>LoadingCache&lt;Key, AtomicLong&gt;</code></td>
            <td>The <code>CacheLoader</code> is returning <code>new AtomicLong()</code> or <code>new AtomicLong(0)</code></td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/util/concurrent/AtomicLongMap.html" target="_blank">AtomicLongMap&lt;Key&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>Pair&lt;Foo, Foo&gt;</code></td>
            <td><code>Foo</code> is <code>Comparable</code>, and <code>first</code> and <code>second</code> represent bounds of a range</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/Range.html" target="_blank">Range&lt;Foo&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>Pair&lt;Foo, Bar&gt;</code></td>
            <td>You are not being forced to use it by go/Flume</td>
            <td>
              Please define a named type with named accessors!
              <a href="https://github.com/google/auto/blob/main/value/userguide/index.md" target="_blank">
                AutoValue
              </a> makes it easy.
            </td>
          </tr>
          <tr>
            <td><code>Comparator&lt;Foo&gt;</code></td>
            <td>You don‚Äôt impose a correct total order, and care only about whether it returns zero or nonzero</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/base/Equivalence.html" target="_blank">Equivalence&lt;Foo&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>Function&lt;Foo, Bar&gt;</code> and <code>Function&lt;Bar, Foo&gt;</code></td>
            <td>The functions convert in both directions between different representations of the same data</td>
            <td>
              <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/base/Converter.html" target="_blank">Converter&lt;Foo, Bar&gt;</a>
            </td>
          </tr>
          <tr>
            <td><code>long</code> and <code>TimeUnit</code></td>
            <td>You are trying to represent an amount of time</td>
            <td>
              <a href="https://docs.oracle.com/javase/8/docs/api/java/time/Duration.html" target="_blank">Duration</a>
            </td>
          </tr>
          <tr>
            <td><code>long</code>, <code>int</code>, <code>double</code>, etc.</td>
            <td>You are trying to represent an amount of time</td>
            <td>
              <a href="https://docs.oracle.com/javase/8/docs/api/java/time/Duration.html" target="_blank">Duration</a>
            </td>
          </tr>
          <tr>
            <td><code>long</code>, <code>int</code>, <code>double</code>, etc.</td>
            <td>You are trying to represent an instant in time (i.e., a timestamp)</td>
            <td>
              <a href="https://docs.oracle.com/javase/8/docs/api/java/time/Instant.html" target="_blank">Instant</a>
            </td>
          </tr>
          </tbody>
        </table>

        <p class="inline-heading">Legacy classes and interfaces to avoid</p>: <br>
        - <code>SortedSet</code> and <code>SortedMap</code>: Replaced by <code>NavigableSet</code> and <code>NavigableMap</code> in Java 6. <br>
        - <code>LinkedList</code>: It is very rare for its performance to beat <code>ArrayList</code> or <code>ArrayDeque</code>. <br>
        - <code>Vector</code>: Use <code>ArrayList</code> <br>
        - <code>Stack</code>: use <code>ArrayDeque</code> <br>
        - <code>Hashtable</code> and <code>Dictionary</code>: use <code>LinkedHashMap</code>
      </div>

      <hr>
      <div id="Tip6" class="chapter">Tip 6: Classes</div>
      <hr>

      <div class="textual-content">
        <p class="inline-heading">Utility Classes</p>: <br>
        By utility class, we mean a class containing only static members. <br>

        1) It's common to see a series of static methods that take a common argument type. Consider adding the method to that type instead, if possible; perhaps even as instance
        methods. For instance, refer the below examples:
        <div class="code-block">
          <div class="expand-code-snip-btn border border-primary rounded">
            <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
          </div>
          <div class="code-snippet">
            <script src="https://gist.github.com/rgbk21/8f96809349c4555e7b857710da548215.js"></script>
          </div>
        </div>

        - When should you keep static utilities? <br>
        a) Cross‚Äëcutting helpers that don‚Äôt logically belong to one type (e.g., preconditions, object mappers). <br>
        b) Pure functions over multiple disparate types where no single receiver is natural. <br>
        c) Factory methods and builders. <br>

        Rule of thumb: If most methods in a util class take the same first parameter type, that‚Äôs a smell. Prefer moving those methods onto that type (as instance methods) or, if
        that‚Äôs impossible, add them via a wrapper or an interface with default methods.
      </div>

      <hr>
      <div id="Tip7" class="chapter">Tip 7: Closing Resources</div>
      <hr>

      <div class="textual-content">

        - This discusses the types which conceptually require "closing" or "cleanup". Specifically, a new instance is returned to a user (whether by a constructor or otherwise),
        and
        that user is expected to call a method on that instance when they are finished using the instance. <br>

        <p class="inline-heading">Avoid the need</p>: <br>
        - The best way to handle this situation is to avoid it entirely by using libraries that operate at a higher level. For example, working with I/O streams requires closing
        those streams when finished. But most I/O needs can be solved using library classes like
        <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/io/ByteSource.html">ByteSource</a> or
        <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/io/CharSink.html">CharSink</a>. Code can be found
        <a href="https://github.com/google/guava/tree/master/guava/src/com/google/common/io">here on GitHub</a>. <br>
        - The reasoning is that if you don't let the user access an opened resource in the first place, they can't forget to close it. <br>

        <p class="inline-heading">Creating a Closeable Type</p>: <br>
        Perhaps it can't be avoided and you must define a closeable type. When doing so:
        - Implement <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/AutoCloseable.html">AutoCloseable</a> in your <code>throws</code> clause,
        declare
        only the specific checked exception types that your implementation can actually throw. <br>
        - After <code>close</code> is called, any methods that cna no longer function properly should throw <code>IllegalStateException</code> if invoked. <br>
        - The API users call to obtain instances of this type should return them in an already "opened", usable state, not require an additional <code>open</code> or
        <code>init</code> method to be called. <br>
        - Supporting <i>reopening</i> the same instance again is atypical and discouraged. <br>
        - Make sure to clearly document any subtypes or returned instances that <i>don't</i> require closing. <br>
        - Consider annotating constructors and methods returning your type as <a href="https://errorprone.info/bugpattern/MustBeClosedChecker">@MustBeClosed</a>. <br>

        <p class="inline-heading">Use "try with resources"</p>: <br>
        - When using an instance of <code>AutoCloseable</code> that will need to be closed you should use the "try with resources" language feature. <br>
        - Note that a <code>catch</code> statement need not be present. At the end of the try block, both <code>in</code> and <code>out</code> will be closed. Importantly,
        <code>in</code> will be closed een if the call to <code>newOutputStream</code> throws an exception, and no thrown exceptions will be swallowed (they are instead attached as
        "suppressed exceptions"). <br>
        - The variables initialized in the <code>try</code> header are <i>usually</i> referenced within the <code>try</code> block, but in some cases they are not, and that is
        okay.
        <div class="code-block">
          <div class="expand-code-snip-btn border border-primary rounded">
            <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
          </div>
          <div class="code-snippet">
            <script src="https://gist.github.com/rgbk21/6295c0dce31e26489b1db5866b0596a1.js"></script>
          </div>
        </div>

        <p class="inline-heading">Preserving Exceptions</p>: <br>
        - It's a common pattern to do some work to initialize some object before returning it to a caller that will eventually close it. But this can be challenging. Refer the code
        below.
        <div class="code-block">
          <div class="expand-code-snip-btn border border-primary rounded">
            <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
          </div>
          <div class="code-snippet">
            <script src="https://gist.github.com/rgbk21/ba615138f2dfc80b446bddd7568b01c5.js"></script>
          </div>
        </div>
      </div>

      <hr>
      <div id="Tip8" class="chapter">Tip 8: Code Generation</div>
      <hr>

      <div class="textual-content">
        - TODO
      </div>

      <hr>
      <div id="Tip9" class="chapter">Tip 9: Collection Implementations</div>
      <hr>

      <div class="textual-content">

        - See <a href="#Tip5">Choosing a collection type</a>. <br>

        <div class="sub-heading">List</div>
        <div>
          - Regular: <code>ImmutableList</code>, <code>ArrayList</code>. <br>
          - Unique elements: <code>StandardUniqueList</code> (internal). <br>
          - Special factories: <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collections.html#nCopies-int-T-"><code>Collections.nCopies()</code></a>,
          <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/Lists.html#asList(E,E,E[])"><code>Lists.asList()</code></a>,
          <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/primitives/ImmutableDoubleArray.html#asList()"><code>ImmutableDoubleArray.asList()</code></a>,
          <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/primitives/Doubles.html#asList(double...)"><code>Doubles.asList()</code></a> <br>
          - Concurrent: <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/CopyOnWriteArrayList.html"><code>CopyOnWriteArrayList</code></a>
        </div>

        <div class="sub-heading">Set</div>
        <div>
          <p class="inline-heading">Regular</p>: <br>
          - Basic: <code>ImmutableSet</code>, <code>HashSet</code>, <code>LinkedHashSet</code> <br>
          - Enum: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/Sets.html#immutableEnumSet(E,E...)"><code>Sets.immutableEnumSet()</code></a>,
          <code>EnumSet</code> <br>
          - Memory-optimized: <a href="https://github.com/google/guava/blob/master/guava/src/com/google/common/collect/CompactHashSet.java"><code>CompactHashSet</code></a>
          (probably
          deprecated),
          <a href="https://github.com/google/guava/blob/master/guava/src/com/google/common/collect/CompactLinkedHashSet.java"><code>CompactLinkedHashSet</code></a> (probably
          deprecated)<br>
          - Identity Semantics:
          <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/Sets.html#newIdentityHashSet()"><code>Sets.newIdentityHashSet()</code></a>
          (does not rely on <code>Object.hashCode()</code> or <code>equals</code> to dedupe the elements). <br>

          <p class="inline-heading">Concurrent</p>: <br>
          - Basics: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/Sets.html#newConcurrentHashSet()"><code>Sets.newConcurrentHashSet</code></a>
          <br>
          - Copy on write: <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CopyOnWriteArraySet.html?is-external=true"><code>CopyOnWriteArraySet</code></a>.
          <br>

          <p class="inline-heading">Comparator-imposed order</p>: <code>NavigableSet</code><br>
          - Basic: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ImmutableSortedSet.html"><code>ImmutableSortedSet</code></a>,
          <code>TreeSet</code><br>
          - Concurrent: <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ConcurrentSkipListSet.html"><code>ConcurrentSkipListSet</code></a> <br>

          <p class="inline-heading">Containing ranges</p>: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/RangeSet.html">RangeSet</a> <br>
          - <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ImmutableRangeSet.html"><code>ImmutableRangeSet</code></a>,
          <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/TreeRangeSet.html"><code>TreeRangeSet</code></a>
        </div>

        <div class="sub-heading">Map</div>
        <div>
          <p class="inline-heading">Regular</p>: <code>Map</code> <br>
          - Basic: <code>ImmutableMap</code>, <code>HashMap</code>, <code>LinkedHashMap</code> <br>
          - Enum Keys: <a
          href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/Maps.html#immutableEnumMap(java.util.Map)"><code>Maps.immutableEnumMap()</code></a>,
          <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/EnumMap.html"><code>EnumMap</code></a>,
          <code>EnumMappers</code> (internal: creates BiMaps between enum and enum) <br>
          - Memory Optimized:
          <a
            href="https://github.com/google/guava/blob/d7240c0eedbef92ca40377e864a77a1e30e91474/guava/src/com/google/common/collect/CompactHashMap.java#L86"><code>CompactHashMap</code></a>
          (probably deprecated),
          <a href="https://github.com/google/guava/blob/d7240c0eedbef92ca40377e864a77a1e30e91474/guava/src/com/google/common/collect/CompactLinkedHashMap.java"><code>CompactLinkedHshMap</code>
          </a> (probably deprecated) <br>
          - Identity Semantics: <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/IdentityHashMap.html"><code>IdentityHashMap</code></a>,
          <a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/WeakHashMap.html"><code>WeakHashMap</code></a> (does not rely on
          <code>Object.hashCode()</code> or <code>equals</code> to index the keys)<br>

          <div class="sub-section">
            Question: What would be the use case for something like a WeakHashMap? <br>
            - A <code>WeakHashMap</code> is a tool used for a very specific purpose: creating caches or associating metadata with objects without preventing those objects from
            being
            garbage collected.Let's break that down.
            <br>

            <p class="inline-heading">The Problem: The Standard HashMap and Memory Leaks</p> <br>
            - Imagine you want to store some extra information (metadata) about objects that are being used elsewhere in your application. A natural first thought is to use a
            <code>HashMap</code>:
            <div class="code-block">
              <div class="expand-code-snip-btn border border-primary rounded">
                <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
              </div>
              <div class="code-snippet">
                <script src="https://gist.github.com/rgbk21/56e30fc0f940be01f9b83ec668384084.js"></script>
              </div>
            </div>
            - This creates a serious problem. The <i>metadataCache</i> now holds a
            <a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/ref/package-summary.html#reachability">strong reference</a> to the <i>widget</i> object
            as
            its key. <br>
            - Even if the rest of your application is completely finished with <i>widget</i> and sets all its references to null, the <i>widget</i> object can never be garbage
            collected. Why? Because your <i>metadataCache</i> is still holding onto it, keeping it alive forever. This is a classic memory leak. Over time, your cache will fill up
            with "dead" widgets and their metadata, eventually causing your application to run out of memory. <br>

            <p class="inline-heading">The Solution: <code>WeakHashMap</code></p> <br>
            - A WeakHashMap solves this exact problem. It works just like a HashMap, but with one crucial difference: A WeakHashMap holds its keys using weak references. A weak
            reference does <i>not</i> prevent an object from being garbage collected. <br>

            - Here‚Äôs how it works in practice: <br>
            1. You put a key-value pair <i>(widget, metadata)</i> into a WeakHashMap. <br>
            2. The rest of your application uses the <i>widget</i> object. <br>
            3. Eventually, the application is done with the widget and all <i>strong references</i> to it are gone. <br>
            4. Now, the only thing pointing to the widget object is the <i>weak reference</i> from the WeakHashMap. <br>
            5. The next time the Garbage Collector (GC) runs, it sees that the widget is only "weakly reachable." It says, "Nobody <i>really</i> needs this anymore," and reclaims
            the memory for the widget object. <br>
            6. The WeakHashMap is designed to notice that its key has been collected. It then automatically removes the entire entry (widget, metadata) from itself. The memory leak
            is
            gone! The cache cleans itself up automatically as the objects it's tracking become irrelevant to the rest of the application.
          </div>

          <p class="inline-heading">Concurrent</p>: ConcurrentMap <br>
          - Basic: <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/ConcurrentHashMap.html"><code>ConcurrentHashMap</code></a> <br>
          - Enum keys: <code>ConcurrentEnumMap</code>(internal - a concurrent map implementation for the special case of enum keys) <br>

          <p class="inline-heading">Comparator-imposed key order</p>: NavigableMap <br>
          - Basic: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ImmutableSortedMap.html"><code>ImmutableSortedMap</code></a>,
          <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/TreeMap.html"><code>TreeMap</code></a> <br>
          - Concurrent: <a
          href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/ConcurrentSkipListMap.html"><code>ConcurrentSkipListMap</code></a>
          <br>

          <p class="inline-heading">Bi-directional</p>: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/BiMap.html">BiMap</a> <br>
          - Basic: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ImmutableBiMap.html">ImmutableBiMap</a>,
          <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/HashBiMap.html">HashBiMap</a> <br>
          - Enum Keys: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/EnumBiMap.html">EnumBiMap</a>,
          <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/EnumHashBiMap.html">EnumHashBiMap</a> <br>

          <p class="inline-heading">Heterogeneous Values</p>: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ClassToInstanceMap.html">ClassToInstanceMap</a>
          or <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/reflect/TypeToInstanceMap.html">TypeToInstanceMap</a> <br>
          - By Class: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ImmutableClassToInstanceMap.html">ImmutableClassToInstanceMap</a>,
          <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/MutableClassToInstanceMap.html">MutableClassToInstanceMap</a>. <br>
          - By type token: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/reflect/ImmutableTypeToInstanceMap.html">ImmutableTypeToInstanceMap</a>,
          <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/reflect/MutableTypeToInstanceMap.html">MutableTypeToInstanceMap</a>. <br>
          - By something else: Item 33 of Effective Java - Consider typesafe heterogeneous containers. <br>

          <p class="inline-heading">Keys in a range</p>: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/RangeMap.html">RangeMap</a> <br>
          - <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ImmutableRangeMap.html">ImmutableRangeMap</a>,
          <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/TreeRangeMap.html">TreeRangeMap</a>.
        </div>


        <div class="sub-heading">Table</div>
        <div>
          - Immutable: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ImmutableTable.html">ImmutableTable</a> <br>
          - Dense Keys: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ArrayTable.html">ArrayTable</a> <br>
          - Sparse Keys: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/HashBasedTable.html">HashBasedTable</a> <br>
          - Comparator-imposed: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/TreeBasedTable.html">TreeBasedTable</a>
        </div>

        <div class="sub-heading">Multiset</div>
        <div>
          - Basic: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ImmutableMultiset.html">ImmutableMultiset</a>,
          <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/HashMultiset.html">HashMultiset</a>,
          <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/LinkedHashMultiset.html">LinkedHashMultiset</a>. <br>
          - Concurrent: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ConcurrentHashMultiset.html">ConcurrentHashMultiset</a> <br>
          - Enum Keys: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/EnumMultiset.html">EnumMultiset</a> <br>
          - Comparator-imposed: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ImmutableSortedMultiset.html">ImmutableSortedMultiset</a>,
          <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/TreeMultiset.html">TreeMultiset</a>.
        </div>

        <div class="sub-heading">Multimap</div>
        <div>
          - Immutable: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ImmutableMultimap.html">ImmutableMultimap</a> <br>
          - Ordered: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ArrayListMultimap.html"></a>,
          <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/LinkedListMultimap.html">LinkedListMultimap</a> <br>
          - Unordered: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/HashMultimap.html">HashMultimap</a>,
          <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/LinkedHashMultimap.html">LinkedHashMultimap</a> <br>
          - Comparator-imposed: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/TreeMultimap.html">TreeMultimap</a>. <br>

          <p class="inline-heading">Bi-directional</p>: BiMultimap (internal) <br>
          - Immutable: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/ImmutableMultimap.html">ImmutableMultimap</a> (no ImmutableBiMultimap
          needed) <br>
          - Ordered: ArrayListBiMultimap <br>
          - Unordered: HashBiMultiMap, LinkedHashBiMultiMap
        </div>

        <div class="sub-heading">Queue</div>
        <div>
          - Unbounded, non-blocking: <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/ArrayDeque.html">ArrayDeque</a>,
          <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/LinkedList.html">LinkedList</a>,
          <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/PriorityQueue.html">PriorityQueue</a>,
          <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/ConcurrentLinkedQueue.html">ConcurrentLinkedQueue</a> <br>
          - Unbounded, blocking: <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/LinkedBlockingQueue.html">LinkedBlockingQueue</a>,
          <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/LinkedBlockingDeque.html">LinkedBlockingDeque</a>,
          <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/SynchronousQueue.html">SynchronousQueue</a> <br>
          - Bounded, blocking: <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/ArrayBlockingQueue.html">ArrayBlockingQueue</a>,
          <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/LinkedBlockingDeque.html">LinkedBlockingDeque</a>,
          <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/LinkedBlockingQueue.html">LinkedBlockingQueue</a>. <br>
          - Bounded, non-blocking: <a href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/collect/EvictingQueue.html">EvictingQueue</a>
        </div>

        <div class="sub-heading">Cache</div>
        <div>
          - For server apps, use <a href="https://github.com/ben-manes/caffeine/wiki">Caffeine</a>.
        </div>

        <div class="sub-heading">Thread-safety</div>
        <div>
          - Consider whether your collection should be thread-safe. <br>
          - Avoid <code>synchronized&lt;Tylpe&gt;</code> wrapper methods like those found in
          <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Collections.html">Collections</a>.

          <div class="sub-section">
            Question: Why is the pattern being used in the Collections java library of using
            <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Collections.html#synchronizedList(java.util.List)">synchronizedList</a> methods, and
            other similar ones, considered not ideal? <br>

            <p class="inline-heading">Answer</p>: <br>
            The advice to avoid the <code>Collections.synchronized*</code> wrappers (like <code>Collections.synchronizedList()</code> and <code>Collections.synchronizedMap()</code>)
            is standard practice in modern Java development. While they do provide a layer of thread-safety, they are considered not ideal for several critical reasons, primarily
            because they offer a false sense of security and have poor performance. <br>

            <p class="inline-heading">1. The Biggest Problem: Compound Actions Are Not Atomic</p> <br>
            - The wrong way:
            <div class="code-block">
              <div class="expand-code-snip-btn border border-primary rounded">
                <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
              </div>
              <div class="code-snippet">
                <script src="https://gist.github.com/rgbk21/5d926c4bdea50d12692b138bf975425a.js"></script>
              </div>
            </div>

            <p class="inline-heading">2. Poor Performance: Coarse-Grained Locking</p> <br>
            - The synchronized wrappers achieve thread-safety by putting a <code>synchronized</code> block around every single method. This means only one thread can access the
            collection at a time for any reason. If Thread A is writing to the collection, Thread B cannot read from it. If Thread A is reading from the collection, Thread B cannot
            read from it either. This creates a massive bottleneck. The entire collection is locked for every operation, which severely limits concurrency and hurts the performance
            of your application, especially under load. This is known as coarse-grained locking. <br>

            <p class="inline-heading">The Modern Solution: The <code>java.util.concurrent</code> Package</p> <br>
            - Classes like <code>ConcurrentHashMap</code>, <code>CopyOnWriteArrayList</code>, and <code>ConcurrentLinkedQueue</code> are almost always the better choice. <br>

            How they are better: <br>
            1) Atomic Compound Actions: They provide atomic methods for common operations. The "check-then-act" problem from before is solved elegantly and safely with a single
            method call.
            <div class="code-block">
              <div class="expand-code-snip-btn border border-primary rounded">
                <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
              </div>
              <div class="code-snippet">
                <script src="https://gist.github.com/rgbk21/b05694d611dd90032a832ac0c22fb42d.js"></script>
              </div>
            </div>

            2) High Performance (Fine-Grained Locking): Instead of locking the entire collection, they use more advanced, fine-grained locking techniques. For example,
            ConcurrentHashMap locks only small portions (or "buckets") of the map. This allows multiple threads to read and write to different parts of the map simultaneously,
            leading to vastly superior performance and scalability. <br>

            3) Fail-Safe Iterators: The iterators for concurrent collections are "fail-safe." They never throw a ConcurrentModificationException. They represent a snapshot of the
            collection at a point in time and are not affected by concurrent modifications, making them much safer and easier to use.
          </div>
        </div>

      </div>

      <hr>
      <div id="Tip10" class="chapter">Tip 10: Comparison</div>
      <hr>

      <div class="textual-content">
        - Java has two ways of comparing objects: <br>
        a) You can use a <a href="https://docs.oracle.com/en/java/javase/21//docs/api/java.base/java/util/Comparator.html"><code>Comparator&lt;T&gt;</code></a> to compare two
        instances of T with <code>comparator.compare(instance1, instance2)</code>. <br>
        b) If a class implements <a href="https://docs.oracle.com/en/java/javase/21//docs/api/java.base/java/lang/Comparable.html"><code>Comparable</code></a>, then you can compare
        instances of that class with <code>instance1.compareTo(instance2)</code>. <br>
        - That said, implementing Comparator and Comparable can be tedious and bug-prone. You can avoid most trouble by following the recommendations below.

        <div class="sub-heading">Comparator</div>
        <div>
          - Typically, comparing two objects goes something like "whichever has the smaller value of the foo() method comes first, and if those are the same, whichever has the
          smaller value of the bar() method comes first, and if those are the same then the objects compare equal". <br>
          - This translates directly into method calls on the <code>Comparator</code> interface.
          <div class="code-block">
            <div class="expand-code-snip-btn border border-primary rounded">
              <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
            </div>
            <div class="code-snippet">
              <script src="https://gist.github.com/rgbk21/de95c1fdb03a0a48b099168b342cd25c.js"></script>
            </div>
          </div>

          - You can use <code>.reversed()</code> at any point in the chain to reverse the sense of the comparison up to that point.
          <div class="code-block">
            <div class="expand-code-snip-btn border border-primary rounded">
              <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
            </div>
            <div class="code-snippet">
              <script src="https://gist.github.com/rgbk21/354393ad90c5bf3776ba54de87553cb6.js"></script>
            </div>
          </div>
        </div>


        <div class="sub-heading">Comparable</div>
        <div>
          - Implementing <code>Comparable</code> defines a "natural order" for a class. The simplest way is with a <code>Comparator</code>.
          <div class="code-block">
            <div class="expand-code-snip-btn border border-primary rounded">
              <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
            </div>
            <div class="code-snippet">
              <script src="https://gist.github.com/rgbk21/1392e12e281842c35d557ee3873db8b9.js"></script>
            </div>
          </div>
        </div>

        <div class="sub-heading"><code>compareTo()</code> should be consistent with <code>equals()</code></div>
        <div>
          - A type's <code>equals()</code> and <code>compareTo()</code> methods should be consistent. This means that, if <code>compareTo()</code> says that two objects are equal
          (that is, if it returns 0 when comparing them), then <code>equals()</code> should return true for those same objects. For a start, <code>equals()</code> and
          <code>compareTo()</code> should compare the same set of fields. <br>
          - If you violate this contract, you will get very surprising and buggy behavior when using your objects in certain collections. <br>
          - Collections like <code>HashSet</code> and <code>ArrayList</code> use <code>equals()</code> to check for containment and uniqueness. <br>
          - Sorted collections like <code>TreeSet</code> and <code>TreeMap</code> use <code>compareTo()</code> (or a <code>Comparator</code>) to check for uniqueness and to
          maintain order. <br>
          - If <code>compareTo</code> and <code>equals</code> are inconsistent, a <code>TreeSet</code> and a <code>HashSet</code> will disagree on whether your collection contains
          a specific object.
        </div>
      </div>

      <hr>
      <div id="Tip11" class="chapter">Tip 11: Concurrency</div>
      <hr>

      <div class="textual-content">
        - Ooga booga concurrency hard. <br>
        - // TODO.
      </div>

      <hr>
      <div id="Tip12" class="chapter">Tip 12: Conditional Failures</div>
      <hr>

      <div class="textual-content">
        - A <i>conditional failure</i>, sometimes called a runtime check or just check, is code that throws an exception if and only if a boolean condition holds. This page
        provides an overview of the common kinds of such checks.

        <div class="sub-heading">Kinds of conditional failures</div>
        <div>
          - Naively, it makes a certain amount of sense to just handle every conditional failure the same way: <code>throw new RuntimException()</code>. <br>
          - However, when you spend a moment to consider the nature of this check, and handle it in the most appropriate way, it will make your code more understandable, and
          errors easier to diagnose. <br>
          - Here are the major kinds of runtime checks. <br>

          <p class="inline-heading">Precondition Check</p>: A precondition check ensures that the <i>caller</i> of a public method has obeyed the requirements of the method's
          specification. For example, a <code>sqrt</code> function may accept only nonnegative args. <br>

          <p class="inline-heading">Verification Check</p>: A verification check is used when you lack high confidence that an API you consume will meet its (real or implied)
          specification. For example, perhaps you have just invoked a weakly-specified remote service that pushes independently from yours, outside of your own service's QA cycle.
          If you don't want to just blindly trust the response, you'll make verification checks. <br>

          <p class="inline-heading">Test Assertion</p>: A test assertion is found in test code only, and ensures that the <i>code under test</i> has obeyed the requirements of its
          own specification. <br>

          <p class="inline-heading">Impossible-condition check</p>: An impossible-conidition check is one that cannot possibly fail, unless surrounding code is later modified, or
          our deepest assumptions about platform behavior are grossly violated. This should be unnecessary, but are often forced because the compiler can't recognise that a
          statement is unreachable. <br>

          <p class="inline-heading">Exceptional Result</p>: An exceptional result means that the method can't provide the expected result, through no fault of its own, nor
          necessarily the fault of any other code involved. This is similar to a precondition check, but here the caller isn't expected to have known any better. It's similar to a
          post-verification check, but failure of the dependency is not unexpected. For example, trying to read a line from a file when end-of-file has already been reached is no
          one's fault; simply an exceptional result. Use checked or unchecked exceptions according to the advice in Effective Java Item 70: Use checked exceptions for recoverable
          conditions and runtime exceptions for programming errors.
        </div>


      </div>

      <hr>
      <div id="Tip13" class="chapter">Tip 13: Constants</div>
      <hr>

      <div class="textual-content">
        <div class="sub-heading">When to use a constant versus an inlined literal?</div>
        <div>
          - Literals (such as explicit strings and numbers) can be assigned to named constants, or just used inline in the flow of code. <br>
          - You should use a constant if either of the following is true: <br>
          a) The same value is used in several places, it's important that they all use the same value, and the value might change. <br>
          b) The value needs some explanation, and a comment at tis use site is awkward. <br>
          - Otherwise, prefer inlining the literal for better readability. <br>
        </div>
      </div>

      <hr>
      <div id="Tip14" class="chapter">Tip 14: Constructors</div>
      <hr>

      <div class="textual-content">
        <div class="sub-heading">Constructors should rarely be <code>public</code></div>
        <div>
          - A constructor has limitations: it must always create a new object, and that object must always be of the exact class that contains the constructor. <br>
          - For public construction, prefer a static factory method in the class to be consturcted, or a <a href="#Tip3">See Tip: Builder</a> or factory class. <br>
          - These alternatives also allow the method name to describe what kind of object is being constructed.
        </div>

        <div class="sub-heading">Avoid doing work in constructors</div>
        <div>
          - The simplest and most common kind of constructor just assigns each of its parameters to a field of the same name and type, perhaps after validation. If your constructor
          does not look like that, consider whether it could. The more additional work the constructor does, the harder it will be to test the class, and especially to test other
          classes that need it. <br>
          - While mocking frameworks like Mockito allow you to get an instance of a class without calling its constructor, that requires the class not to be <code>final</code>, and
          can impose further constraints. Having a simple constructor gives test writers the option of constructing a real instance of the class without having to worry about
          whether the constructor will behave as expected. <br>
          - If a constructor calls an instance method, that method may observe the instance in a partially constructed state, with some fields still having default values. This is
          especially likely if the class can be subclassed. See: Effective Java Item 19 - Design and document for inheritance or else prohibit it. <br>
          - Instead of doing work in the constructor, consider whether it could be done in a factory method or class, in a builder, or when an <code>@Inject</code> constructor's
          parameters are derived by Guice or Dagger.
          <div class="code-block">
            <div class="expand-code-snip-btn border border-primary rounded">
              <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
            </div>
            <div class="code-snippet">
              <script src="https://gist.github.com/rgbk21/0a9d2cda79cbbf6476d578d7e47c8d09.js"></script>
            </div>
          </div>
        </div>

        <div class="sub-heading">Overloads</div>
        <div>
          - Overloaded constructors are typically used to allow some parameters to be optional. Prefer to have each of the other constructors chain directly to the big constrctor
          rather than chaining each to the next. This makes less work for the reader.
        </div>

        <div class="sub-heading">Avoid unwieldy parameter lists</div>
        <div>
          - Can you combine multiple parameters into a value type that meaningfully encloses them, that would make your code cleaner and easier to work with? This can become
          useful when dealing with multiple strings or boolean values.
        </div>

        <div class="sub-heading">Avoid Instance initializers</div>
        <div>
          - Java also supports <a href="https://docs.oracle.com/javase/tutorial/java/javaOO/initial.html">instance intializers</a>, {}-delimited code blocks that are executed when
          an instance is first constructed. Put the code in the constructor instead. <br>
          - In particular, never use the <a href="https://errorprone.info/bugpattern/DoubleBraceInitialization">double-braced initiailization pattern</a>. Introduces memory leak.
        </div>
      </div>


      <hr>
      <div id="Tip15" class="chapter">Tip 15: Dates and Times</div>
      <hr>

      <div class="textual-content">
        - If you are using Java 8+, you should be using JavaTime. Avoid using date/time APIs in <code>java.util</code> like <code>java.util.date</code>,
        <code>java.sql.Timestamp</code>, <code>java.util.calendar</code>, <code>java.util.TimeZone</code>. If you have to interact with an APIs that requires these types, you
        should immediately convert them to one of the previously mentioned APIs. <br>
        - If you want to use the value of "now", use an <a href="https://docs.oracle.com/en/java/javase/21//docs/api/java.base/java/time/InstantSource.html">InstantSource</a> for
        <code>java.time</code>.

        <div class="sub-heading">Get <i>wall time</i> with a <code>InstantSource</code> or <code>Clock</code></div>
        <div>
          - If you are <i>not</i> measuring elapsed time, but just need to know the value of "now", use: <br>
          a) for JavaTime, use <a href="https://docs.oracle.com/en/java/javase/21//docs/api/java.base/java/time/InstantSource.html"><code>InstantSource</code></a> for a
          time-zone-independent answer. Use <code>java.time.Clock</code> if you are operating in the context of a particular time zone, but this type is lightly discouraged.
        </div>

        <div class="sub-heading">When measuring <i>elapsed</i> time locally, prefer <code>Stopwatch</code></div>
        <div>
          - Be aware that functions such as <code>System.currentTImeMillis()</code>, <code>Instant.now()</code>, <code>instantSource.instant()</code>, or
          <code>clock.instant()</code> are not guaranteed to be monotonic. Using them to compute an elapsed time can produce invalid results. <a
          href="https://guava.dev/releases/snapshot-jre/api/docs/com/google/common/base/Stopwatch.html">Stopwatch</a> abstracts away the underlying time source and is intended to
          provide a valid elapsed time. <br>
          - If you can't use <code>Stopwatch</code>, prefer <a href="https://docs.oracle.com/en/java/javase/21//docs/api/java.base/java/lang/System.html#nanoTime()">System.nanoTime()</a>
          which is montonic. Remember that nanoTime values are only meaningful relative to other nanoTime values produced on the same JVM instance. <br>
          - Additional considerations when using
          <cdoe>Stopwatch</cdoe>
          : <br>
          a) It can only measure elapsed time within its own lifetime. This means you may need to make your <code>Stopwatch</code> instance singleton or static. <br>
          b) Stopwatch is not immutable. So it is not threadsafe. <br>
          c) If you want to measure elapsed time that spans JVM restart, neither <code>Stopwatch</code> nor <code>System.nanoTime</code> will be an option.
        </div>

        <div class="sub-heading">Avoid using primitives (eg. <code>double</code>, <code>long</code>, <code>String</code>) to represent dates or times</div>
        <div>
          - If you need to represent a point in time, use the <a href="https://docs.oracle.com/en/java/javase/21//docs/api/java.base/java/time/Instant.html">Instant</a> type. Do
          not use a <code>long</code> that represents the seconds or ms since epoch. A <code>long</code> is ambiguous with unit. <br>
          - If you need to represent elapsed time, use <a href="https://docs.oracle.com/en/java/javase/21//docs/api/java.base/java/time/Duration.html">Duration</a> type. Do not use
          <code>double</code> or <code>long</code>. Never use an <code>int</code>. An <code>int</code> of milliseconds will overflow after 3.5 weeks and an <code>int</code> of
          nanoseconds after 2.1 seconds. <br>
          - A method in a Date/Time API should never accept a bare numeric value.
        </div>

        <div class="sub-heading">Converting between time units</div>
        <div>
          - If you need to convert units, prefer this order: <br>
          1) Use the static factory methods and the conversion methods on <a
          href="https://docs.oracle.com/en/java/javase/21//docs/api/java.base/java/time/Duration.html">Duration</a>.
          <code>long milliseconds = java.time.Duration.ofSeconds(seconds).toMillis();</code>. Thses APIs correctly throw <code>ArithmeticException</code> if an overflow occurs.
          <br>
          2) If you cannot use <code>java.time</code> and you require sub-millisecond precision, consider using <a
          href="https://docs.oracle.com/en/java/javase/21//docs/api/java.base/java/util/concurrent/TimeUnit.html">TimeUnit</a>.
          <code>long milliseconds = TimeUnit.SECONDS.toMillis(seconds);</code>. Additionally, <code>TimeUnit.toUnit(long)</code> and <code>TimeUnit.convert()</code> silently
          saturates to <code>Long.MIN_VALUE</code> on negative overflows and <code>Long.MAX_VALUE</code> on positive overflows. <br>
          3) If you do need to do your own calculations, use <a href="http://guava.dev/releases/snapshot-jre/api/docs/com/google/common/math/LongMath.html">LongMath</a> to throw
          <code>ArithmeticException</code> on overflows. As tempting as it may be, do not just use standard multiplication:
          <code>long milliseconds = seconds * 1000;</code>.
        </div>
      </div>

      <hr>
      <div id="Tip15.1" class="chapter">Tip 15.1: Java Time</div>
      <hr>

      <div class="textual-content">
        - This is the main set of APIs for the java.time library
        <table class="table table-bordered table-sm">
          <thead>
          <tr>
            <th>Type</th>
            <th>Informal Meaning</th>
            <th>Example</th>
            <th>Notes</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/Duration.html" target="_blank">Duration</a></td>
            <td>an amount of time in terms of seconds and nanoseconds</td>
            <td>34.5 seconds</td>
            <td>be careful of <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/Duration.html#isNegative()" target="_blank">negative durations</a>
            </td>
          </tr>
          <tr>
            <td><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/Instant.html" target="_blank">Instant</a></td>
            <td>a single instantaneous point on the timeline</td>
            <td>1985-05-31T16:19:23Z</td>
            <td>n/a</td>
          </tr>
          <tr>
            <td><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/ZoneId.html" target="_blank">ZoneId</a></td>
            <td>a region-based time-zone ID</td>
            <td>Europe/Paris</td>
            <td>n/a</td>
          </tr>
          <tr>
            <td><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/LocalDate.html" target="_blank">LocalDate</a></td>
            <td>a date without a time zone</td>
            <td>2007-12-03</td>
            <td>n/a</td>
          </tr>
          <tr>
            <td><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/LocalDateTime.html" target="_blank">LocalDateTime</a></td>
            <td>a date-time without a time zone</td>
            <td>2007-12-03T10:15:30</td>
            <td>n/a</td>
          </tr>
          <tr>
            <td><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/LocalTime.html" target="_blank">LocalTime</a></td>
            <td>a time without a time zone</td>
            <td>10:15:30</td>
            <td>n/a</td>
          </tr>
          <tr>
            <td><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/InstantSource.html" target="_blank">InstantSource</a></td>
            <td>an interface for accessing the current instant</td>
            <td>n/a</td>
            <td>replaces TimeSource</td>
          </tr>
          <tr>
            <td><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/Clock.html" target="_blank">Clock</a></td>
            <td>a clock that provides access to current instant, date, and time using a time zone</td>
            <td>n/a</td>
            <td><em>discouraged</em> in favor of <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/InstantSource.html"
                                                    target="_blank">InstantSource</a></td>
          </tr>
          <tr>
            <td><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/Period.html" target="_blank">Period</a></td>
            <td>a quantity of time represented in days, months, years</td>
            <td>1 Year and 3 Months</td>
            <td><em>lightly discouraged</em></td>
          </tr>
          <tr>
            <td><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/ZonedDateTime.html" target="_blank">ZonedDateTime</a></td>
            <td>a date-time with a time zone</td>
            <td>2007-12-03T10:15:30+01:00 Europe/Paris</td>
            <td><em>discouraged</em></td>
          </tr>
          </tbody>
        </table>

        <div class="sub-heading">Be careful when decomposing <code>Duration</code></div>
        <div>
          - Decomposing a <code>Duration</code> to a numerical primitive is complicated. Please follow this advice: <br>
          a) Use <a href="https://docs.oracle.com/en/java/javase/21//docs/api/java.base/java/time/Duration.html#toDays()">Duration.to<i>Unit</i></a> to convert a
          <code>Duration</code> to a numeric primitive. <br>
          b) Use <a href="https://docs.oracle.com/en/java/javase/21//docs/api/java.base/java/time/Duration.html#getSeconds()">getSeconds()</a> and <a
          href="https://docs.oracle.com/en/java/javase/21//docs/api/java.base/java/time/Duration.html#getNano()">getNano()</a> to serialize a <code>Duration</code> without losing
          precision. Both these methods should always be called together. <br>
          c) Do not use <code>Duration.to<i>Unit</i>Part()</code> unless you're formatting a <code>Duration</code> for human consumption.
        </div>

        <div class="sub-heading">Be careful of negative <code>Duration</code></div>
        <div>
          - <code>Duration</code> instances are signed, ie, they can represent a negative amount of time.
          <div class="code-block">
            <div class="expand-code-snip-btn border border-primary rounded">
              <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
            </div>
            <div class="code-snippet">
              <script src="https://gist.github.com/rgbk21/0edc8dba47fc985d25baef55550b184b.js"></script>
            </div>
          </div>
        </div>

        <div class="sub-heading">Avoid any APIs that use the default system time zone</div>
        <div>
          - Relying on the system's default time zone is often dangerous. It can vary from machine to machine. Use explicit timezone or just use UTC. <br>
          - Examples of APIs that use the default time zone include: <br>
          <code>LocaDate.now()</code>, <code>LocalDateTime.now()</code>, <code>LocalTime.now()</code>, <code>OffsetDateTime.now()</code>, <code>ZonedDateTime.now()</code>,
          <code>Clock.systemDefaultZOne()</code>. <br>
          - If you absolutely need the timezone of the user machine, pass
          <a href="https://docs.oracle.com/en/java/javase/21//docs/api/java.base/java/time/ZoneId.html#systemDefault()">ZoneId.systemDefault()</a> to these methods.
        </div>

        <div class="sub-heading">Avoid any APIs that use the default system clock</div>
        <div>
          - A dependency on the system default clock should be explicit as well as indirect (so that a mock/fake can be substituted during unit testing). APIs such as <code>Instant.now()</code>
          <i>implicitly</i> rely on system clock and are a direct dependency making it impossible to substritute a fake/mock. <br>
          - Use <a href="https://docs.oracle.com/en/java/javase/21//docs/api/java.base/java/time/InstantSource.html">InstantSource</a> instead.
        </div>

        <div class="sub-heading">Be careful when using <code>java.time.Period</code></div>
        <div>
          - If you have a Period that represents the time between January 10th and February 12th, <code>period.getDays()</code> will return 2 and not 33 as you might expect. For
          that, you must use <a
          href="https://docs.oracle.com/en/java/javase/21//docs/api/java.base/java/time/temporal/ChronoUnit.html#between(java.time.temporal.Temporal,java.time.temporal.Temporal)">ChronoUnit.between()</a>.
        </div>

        <div class="sub-heading">Avoid offset-based "time zones"</div>
        <div>
          - Always use canonical time zones in the Region/Coty format, like America/Los_Angeles. Do <i>not</i> use "time zones" represented by raw offsets, lik +02:00. For one,
          they do not respect daylight savings changes.
        </div>
      </div>


      <hr>
      <div id="Tip16" class="chapter">Tip 16: Dependency Injection</div>
      <hr>

      <div class="textual-content">
        - // TODO.
      </div>

      <hr>
      <div id="Tip17" class="chapter">Tip 17: Enums</div>
      <hr>

      <div class="textual-content">
        - Read chapter 6 of Effective Java. <br>
        <div class="sub-heading">Deeply immutable</div>
        <div>
          - Enum objects should always be deeply immutable. That is, each field of an enum class should be <code>final</code>, and if it holds a reference, that reference should be
          to a deeply immutable object. <br>
          - Enum state is a static state (// TODO: link static state when done), and modifiable static state is dangerous enough in general. But for enum values there is an even
          stronger expectation of immutability, ie "Enum Constants". <br>
          - If the field's type much be mutable, take pains to make sure the value can't observably change; for example by returning only copies of the value to the callers.
        </div>

        <div class="sub-heading">Don't rely on <code>ordinal()</code></div>
        <div>
          - You should almost never invoke the <code>ordinal()</code> method, nor depend on some enum constant being at a particular index of the <code>values()</code> array. The
          ordinal value is not stable when enum values are added, removed, or reordered. <br>
          - Instead, introduce an <code>int</code> field in the enum class to explicitly contain the value you want. <a
          href="https://docs.oracle.com/javase/specs/jls/se8/html/jls-8.html#jls-8.9.2">Example</a>.
        </div>

        <div class="sub-heading">If order means anything, <i>specify it</i></div>
        <div>
          - Every enum type exposes the ordering of its constants, in several ways including: <br>
          a) It implements <code>Comparable</code> based on the constants' declaration order. <br>
          b) It provides a static <code>values()</code> method, which returns an array of its constant values in that same order <br>
          c) <a href="https://docs.oracle.com/en/java/javase/21//docs/api/java.base/java/util/EnumSet.html">EnumSet</a> iteration preserves that order as well. <br>
        </div>

        <div class="sub-heading">Prefer <code>equals()</code> over <code> == </code></div>
        <div>
          - For enum types, should you use <code>e1 == e2</code>, or <code>e1.equals(e2)</code> / <code>Objects.equals(e1, e2)</code>? First try to bypass the question entirely bu
          following the advice in the next section. Barring that. <br>
          - Both choices produce the correct result. However, we want the code to be <i>self-evidently</i> correct: <br>
          a) If <i>e1</i> is not nullable, use <code>e1.equals(e2)</code><br>
          b) Otherwise, use <code>Objects.equals(e1, e2)</code>
        </div>

        <div class="sub-heading">Switching on an enum type</div>
        <div>
          - See also // TODO: Link Switch Statements section <br>

          <p class="inline-heading">Consider a method on the enum type first</p>: <br>
          - Before writing a switch statement on an enum type, consider whether you could add the behavior via an instance method on the enum itself. This approach is preferable if
          the behavior in question is relatively simple, useful, and free of dependencies. Otherwise, or if that change can't be made, use <code>switch</code>. <br>
          - There are two good ways to implement such a method in the enum class:
          <div class="code-block">
            <div class="expand-code-snip-btn border border-primary rounded">
              <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
            </div>
            <div class="code-snippet">
              <script src="https://gist.github.com/rgbk21/5c77dd35207722a01a746087cff7f568.js"></script>
            </div>
          </div>

          <p class="inline-heading">Advantages over if/else</p>: <br>
          - If <i>Bar</i> is an enum type, it's possible to write this code:
          <div class="code-block">
            <div class="expand-code-snip-btn border border-primary rounded">
              <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
            </div>
            <div class="code-snippet">
              <script src="https://gist.github.com/rgbk21/c4172da066d98158644a16253eeeb75f.js"></script>
            </div>
          </div>

        </div>


      </div>

      <hr>
      <div id="Tip18" class="chapter">Tip 18: Equals</div>
      <hr>

      <div class="textual-content">
        - Override <code>Object.equals</code> to express when two instances of your class should be considered <i>interchangeable</i>. You should almost never care which of two
        equal instances you have. If instances are never interchangeable, you probably don't want to override
        <code>equals</code>.

        <div class="sub-heading">Mutable Objects</div>
        <div>
          - You should generally avoid overriding <code>equals</code> in a mutable object, for at least two reasons: <br>
          a) Again, <i>equal means interchangeable</i>. Mutable instances can't really be considered interchangeable, since modifying one won't change the other. <br>
          b) If equals depends on any mutable state, perplexing bugs can result if that state changes while the object is contained in a collection such as a <code>HashSet</code>.
          <br>
          - Whenever you object "feels like" a value type, then <i>not</i> overriding equals may surprise users and casue problems. The solution is simple: <i>make your value types
          immutable</i>, then override equals without any danger. Ideally using <a
          href="https://docs.oracle.com/en/java/javase/21//docs/api/java.base/java/lang/Record.html">Record</a> classes. <br>
        </div>

        <div class="sub-heading">Implementation and hash code</div>
        <div>
          - Strongly recommend using <a href="https://docs.oracle.com/en/java/javase/21//docs/api/java.base/java/lang/Record.html">Record</a> to create value types instead of
          writing them by hand. <br>
          - There are many styles of <code>equals</code> that work. Here is an approach:
          <div class="code-block">
            <div class="expand-code-snip-btn border border-primary rounded">
              <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
            </div>
            <div class="code-snippet">
              <script src="https://gist.github.com/rgbk21/74f47f7bfa8f2aec2195f19aa9ff0450.js"></script>
            </div>
          </div>
        </div>

        <div class="sub-section">
          Question: In the above gist, what is the <code>that</code>? <br>
          - The <code>that</code> you're seeing is part of a modern Java feature called Pattern Matching for <code>instanceof</code>, which was made standard in Java 16. <br>

          <p class="inline-heading">What is <code>that</code></p>: <br>
          - <code>that</code> is a new variable that is automatically created and assigned if the <code>instanceof</code> check is successful. <br>
          - <code>return object instanceof EqualsStuff that && ...</code> expression does two things in one step: <br>
          1. Checks the type: It tests if the incoming object is an instance of the EqualsStuff class. <br>
          2. Creates a variable: If the check is true, it automatically casts object to the type EqualsStuff and assigns it to a new, strongly-typed variable named
          <code>that</code>. This new <code>that</code> variable is then immediately available to be used in the rest of the boolean expression, allowing you to safely access the
          fields of EqualsStuff like <code>that.anIntField</code>. <br>

          - Here is a comparison of how we would have written the same code before and after 16:
          <div class="code-block">
            <div class="expand-code-snip-btn border border-primary rounded">
              <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
            </div>
            <div class="code-snippet">
              <script src="https://gist.github.com/rgbk21/6de6e0506eb27e45be3e7f18f800e9fb.js"></script>
            </div>
          </div>

          <p class="inline-heading">What are some other use cases of using Pattern Matching</p>: <br>
          <div class="code-block">
            <div class="expand-code-snip-btn border border-primary rounded">
              <span class="btn btn-link">Expand Gist <img src="../imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
            </div>
            <div class="code-snippet">
              <script src="https://gist.github.com/rgbk21/4383928f494ea98c1d77cd1d922f5f70.js"></script>
            </div>
          </div>

        </div>

        <div class="sub-heading">Test!</div>
        <div>
          - Use <a href="https://www.javadoc.io/doc/com.google.guava/guava-testlib/latest/com/google/common/testing/EqualsTester.html">EqualsTester</a> or <a
          href="https://www.javadoc.io/doc/com.google.guava/guava-testlib/latest/com/google/common/testing/ClassSanityTester.html">ClassSanityTester</a>. Or just use java records.
        </div>
      </div>

      <hr>
      <div id="Tip19" class="chapter">Tip 19: Exceptions</div>
      <hr>

      <div class="textual-content">
        <div class="sub-heading">Catching Exceptions: Should you catch at all?</div>
        <div>
          - Just because a method you're calling can throw an exception doesn't mean <i>you</i> should catch it. Often the best thing to do is let exceptions propagate to your
          caller, so they can decide how to handle them. <br>
          - And it's <i>always</i> better to let an exception propagate than to mishandle it: <br>
          a) <a href="#Tip19_emptyCatchBlocks">Don't write empty catch blocks</a>. <br>
          b) If you return <code>null</code> (or an empty or "zero" value that might require special handling), document that behavior, perhaps using nullness annotations. (//
          TODO: Link to nullness section). <br>
          c) If you throw another exception, make sure that it <a href="#Tip19_wrapping">wraps the original</a> so as to <a href="#Tip_19_preserveCausalChain">preserve its causal
          chain</a>. <br>
          d) <a href="#Tip19_rethrowingException">Don't rethrow an exception that may come from another thread</a>. <br>

          - In many cases, exceptions will be handled by surrounding framework. For instance: <br>
          a) In a test method, you can just add <code>throws Exception</code> and let the testing framework catch any exception and fail the test. <br>
          b) Most concurrency frameworks (like Dagger) allow your operations to throw checked exceptions. <br>
          c) Some APIs offer separate methods for operations that may throw checked exceptions. <br>
          d) Stream API was designed to work with functional interfaces like <code>Function&lt;T, R&gt;</code>, <code>Predicate&lt;T&gt;</code> etc. These interfaces do not allow
          checked exceptions in their method signatures. For example:

          <pre><code class="language-java">
  Stream.of("a.txt", "b.txt")
    .map(Files::readString) // compile error: readString throws IOException (checked)
    .forEach(System.out::println);
</code></pre>
        </div>

        <div class="sub-heading">Is an API forcing an unjustified checked exception on you?</div>
        <div>
          - Sometimes you will call a method that declares that it may thorw a checked exception, but you know that yiou call can never cause that exception. Or the exceptional
          condition might still be <i>possible</i>, but you would be better served by a method that throws an unchecked exception, or handles the error internally. <br>
          - In many of these cases, you are stuck with that method, and you'll have to catch the excption or let it propagate. <br>
          - Also see the examples in impossible conditions section (// TODO).
        </div>

        <div class="sub-heading">Exception chaining (or propagating)</div>
        <div>
          - If you can't handle an exception, and it isn't appropriate to let it propagate as-is, you should almost always wrap the caught exception as a <a
          href="https://docs.oracle.com/en/java/javase/21//docs/api/java.base/java/lang/Throwable.html#getCause()">cause</a> of another <a href="#Tip19_throwTypeAppropriate">appropriately-typed</a>
          exception and throw that. Extending the causal chain this way ensures that exception stacktraces are complete. Nearly all <code>Exception</code> and <code>Error</code>
          subclasses accept an optional <code>Throwable</code> cause constructor argument.
          <pre><code class="language-java">
  try {
    // do stuff
  } catch (InnerException e) {
    // set e as cause of the new exception
    throw new OuterException("Failed do the thing", e);
  }
</code></pre>
          - If possible, the constructed exception's message should include additional context for the failure beyojnd just the underlying cause. Just don't <a
          href="Tip19_Messages">overdo it</a>. (// TODO). <br>
          - If the failure should be impossible (// TODO: Link), rethrow it wrapped in an <code>AssertionError</code>.
        </div>

        <div class="sub-heading"><code>catch(Throwable t)</code></div>
        <div>
          - This is usually not what you want to do. Most subclasses of Error are really not meant to be caught.
        </div>

        <div class="sub-heading"><code>catch(Exception e)</code> or <code>catch(RuntimeException e)</code></div>
        <div>
          - This is <i>sometimes</i> necessary, but don't do it as a shortcut for catching all of the individual exception tyeps you need to catch. For that, use <a
          href="#Tip19_MultiCatch">multi-catch</a> (// TODO).
          <pre><code class="language-java">
  try {
    // do stuff
  } catch (Exception1 | Exception2 e) {
    // handle them both in the same way.
  }
</code></pre>

          - Only catch <code>Exception</code> when you legitimately want to handle <i>any</i> checked or unchecked exception that may arise, including ones that you don't expect to
          actually happen. In particular, take care that you don't suppres <code>InterruptedException</code>. (// TODO: Add Link to section). <br>
          - Similarly, if you're calling a method that throws only unchecked exceptions, you shouldn't catch <code>RuntimeException</code> to handle them unless you truly intend to
          catch all such possible exceptions.
        </div>

      </div>


    </div>
  </div>
</div>

<button id="scrollToTopBtn" title="Go to top"><i class="fa fa-arrow-up"></i></button>
<script src="../../../script.js"></script>
<script src="../../../sidebar.js"></script>
</body>
</html>
