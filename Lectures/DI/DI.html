<!DOCTYPE html>
<html lang="en">
<head>
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
          integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
          crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
          integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
          crossorigin="anonymous"></script>
  <link rel="stylesheet"
        href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
        crossorigin="anonymous">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
          integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
          crossorigin="anonymous"></script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-9QJ5D3X353"></script>
  <script>
      window.dataLayer = window.dataLayer || [];

      function gtag() {
          dataLayer.push(arguments);
      }

      gtag('js', new Date());
      gtag('config', 'G-9QJ5D3X353');
  </script>

  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,300;0,400;0,500;1,400&display=swap"
        rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="../../globalStyles.css">
  <meta name="author" content="Raj Gaurav Ballabh Kumar">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DI</title>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">

  <div class="navbar-header">
    <a href="../../index.html" class="navbar-brand"> rgbk21</a>
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"><span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="nav navbar-nav">
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Projects</a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="../../Projects/TwitterCritNodes/TwitterCritNodes_1.html">Identifying Critical Nodes on Twitter</a>
          <a class="dropdown-item" href="../../Projects/isRelatedTo/isRelatedTo.html">isRelatedTo</a>
          <div class="dropdown-divider"></div>
        </div>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">HTML Projects</a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="../../Pig_Game/index.html">2-Player Pig Game</a>
          <a class="dropdown-item" href="../../ImageGallery/ImageGallery.html">Image Gallery</a>
          <a class="dropdown-item" href="../../RGB_Guesser_Game/RGB.html">RGB Guesser Game</a>
          <a class="dropdown-item" href="../../ToDoList/todo.html">To-Do List</a>
          <div class="dropdown-divider"></div>
        </div>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Notes</a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="../../Lectures/COMS_631/COMS_631_index.html">COMS 631</a>
          <a class="dropdown-item" href="../../Lectures/COMS_535/COMS_535_index.html">COMS 535</a>
          <a class="dropdown-item" href="../../Lectures/EffectiveJava/EffectiveJava.html">Effective Java</a>
          <a class="dropdown-item" href="../../Lectures/DI/DI.html">Dependency Injection</a>
          <div class="dropdown-divider"></div>
        </div>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Code</a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="../../Code/ThingsToRemember/ThingsToRemember.html">Things To Remember</a>
          <a class="dropdown-item" href="../../Code/Java_Notes/JavaNotes.html">Java Notes</a>
          <a class="dropdown-item" href="../../Code/Java_Notes/JavaNotes_2.html">Java Notes 2</a>
          <a class="dropdown-item" href="../../Code/LeetCode/LeetCode.html">LeetCode Notes</a>
          <a class="dropdown-item" href="../../Code/Applying_Java_Notes/ApplyingJava_Notes.html">ApplyingJava Notes</a>
          <a class="dropdown-item" href="../../Code/JavaScript/JavaScript.html">JavaScript Notes</a>
          <a class="dropdown-item" href="../../Code/HTML_CSS/HTML_CSS_Basics.html">HTML & CSS Notes</a>
          <a class="dropdown-item" href="../../Code/SQL/SQL.html">SQL Notes</a>
          <a class="dropdown-item" href="../../Code/Spring/Spring.html">Spring Notes</a>
          <a class="dropdown-item" href="../../Code/Kafka/Kafka.html">Kafka Notes</a>
          <a class="dropdown-item" href="../../Code/Angular/Angular.html">Angular</a>
          <a class="dropdown-item" href="../../Code/Hibernate/Hibernate.html">Hibernate</a>
          <div class="dropdown-divider"></div>
        </div>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">In Another Life</a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="../../InAnotherLife/Chapter1/Chapter1.html">Chapter 1</a>
          <div class="dropdown-divider"></div>
        </div>
      </li>
    </ul>


    <ul class="navbar-nav ml-auto">
      <li class="nav-item active"><a class="nav-link" href="https://github.com/rgbk21">GitHub</a></li>
      <li class="nav-item active"><a class="nav-link" href="https://www.linkedin.com/in/raj-gaurav-ballabh-kumar-97002058/">LinkedIn</a></li>
      <li class="nav-item active"><a class="nav-link" href="https://www.instagram.com/wobblyframes/">Instagram</a></li>
      <li class="nav-item active"><a class="nav-link" href="https://www.facebook.com/SomeRandomThoughts">Facebook</a></li>
    </ul>
  </div>
</nav>

<div class="container">

  <button id='load-all-gists' type="button" class="btn btn-outline-primary">Show all Gists!</button>

  <div>
    This page contains my notes from the following books: <br>
    a) Dependency Injection in Action by Prasanna <br>
  </div>


  <br>
  Index for Book: <br>
  Chapter 0 - <a href="#InterestingLinks">Interesting Links</a> <br>
  Chapter 1 - <a href="#Chapter1">Dependency injection: what's all the hype</a> <br>
  Chapter 2 - <a href="#Chapter2">Time for Injection</a> <br>
  Chapter 3 - <a href="#Chapter3">Investigating DI</a>


  <br>

  <hr>
  <div id="InterestingLinks" class="chapter">Interesting Links</div>
  <hr>

  <div class="textual-content">

    <div class="sub-heading">Links</div>
    <div>
      -
    </div>
  </div>

  <hr>
  <div id="Chapter1" class="chapter">Chapter 1: Dependency injection - what's all the hype?</div>
  <hr>

  <div class="textual-content">
    <div class="sub-heading">Seeing objects as services</div>
    <div>
      - A central idea in this book is that - <i>of an object acting as a service</i>. Take an email sending service for example. The email itself can be viewed as a message
      composition service, the internet relays that are routing the email to its destination as delivery agents, and the receiver's inbox as a receiving service. <br>
      - Consider the following architecture for the service:
      <img src="imgs/ch1/EmailMessagingService.PNG"
           class="center-block img-fluid"
           alt="EmailMessagingService"
           width="700">
      - Let the three objects responsible for these actions be: <code>Emailer</code>, <code>InternetRelay</code>, <code>RecipientInbox</code>. Each object is a <i>client</i>
      of the next. <code>Emailer</code> uses the <code>InternetRelay</code> as a service to send email, and in turn, the <code>InternetRelay</code> uses the
      <code>RecipientInbox</code>
      as a service to deliver sent mail. <br>
      - There's value in decomposing our services into objects. Take the <code>Emailer</code> for example. The <code>Emailer</code> will require a text editor to type-in the
      email. This logic could be added in the <code>Emailer</code> class itself, but it is better to create a new <code>TextEditor</code>. Pulling this functionality into its
      own class has the following advantages: <br>
      a) Our <code>Emailer</code> is not cluttered with distracting code meant for text manipulation. <br>
      b) We can reuse the <code>TextEditor</code> component in other scenarios (say, a calendar or note-taking application) without much additional coding. <br>
      c) If someone else has written a general-purpose text-editing component, we can make use of it rather than writing one from scratch <br>
      - This principle is important because it highlights the relationship between one object and other objects it uses to perform its function: an object depends on its
      services in order to perform its function. In this example that we are talking about, the <code>Emailer</code> class depends upon a <code>TextEditor</code>,
      <code>SpellChecker</code>, and a <code>Dictionary</code> to perform its functions. Hence these 3 classes are the <i>dependencies</i> of the <code>Emailer</code> class.
      In other words, the <code>Emailer</code> class is a <i>client</i> of its <i>dependencies</i>. <br>
      - The dependencies of the <code>Emailer</code> class may have dependencies of their own and this relationship carries on transitively. This composite system of
      dependencies is known as the <i>object graph</i>. <br>
      - Hence we get the following definitions: <br>
      a) <p class="inline-heading">Service</p>: An object that performs a <i>well-defined</i> function when it is called. <br>
      b) <p class="inline-heading">Client</p>: Any consumer of a service. A client calls a service to perform a <i>well-understood</i> function. <br>
      c) <p class="inline-heading">Dependency</p>: A specific service that is <i>required</i> by another object to fulfill its function. <br>
      d) <p class="inline-heading">Dependent</p>: A client object that needs a dependency (or dependencies) in order to perform its function. <br>
      e) <p class="inline-heading">Dependency Injection</p>: DI is the study of reliably and efficiently building such object graphs and the strategies, patterns, and best
      practices therein. <br>
    </div>

    <div class="sub-heading">Pre DI Solutions</div>
    <div>
      - Suppose you were asked to create an <code>Emailer</code> which is composed of a <code>SpellChecker</code>, this might be the first thing that you come up with:
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/b8be3cd32369ab39bd09f6e334f47985.js"></script>
        </div>
      </div>
      - But what is the problem with this approach? Suppose you wanted to test that the <code>SpellChecker</code> was in-fact being called when you used the <i>send</i>
      method to send an email. One way to do this would be to create a <code>MockSpellChecker</code>and make <code>Emailer</code> use that:
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/14034bdca00106464dad5a0c52d1434d.js"></script>
        </div>
      </div>
      - But now you cannot use this mock because you cannot substitute the internal spellchecker that the <code>Emailer</code> class has. This effectively makes the
      <code>Emailer</code> class untestable. <br>
      - There is another problem with this approach. You cannot create objects of the same <code>Emailer</code> class with different functionality. For instance, suppose you
      were writing an email client for the english language, then you would do something like:
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/45b4380ab5c6575fcfca05017208a99b.js"></script>
        </div>
      </div>
      - Now if you wanted to use the same <code>Emailer</code> class for the french language, you would have to create a completely new <code>Emailer</code> class. We need
      another system where instead of the dependent creating its own dependencies, it has them provided externally. <br>
    </div>

    <div class="sub-heading">Construction by hand</div>
    <div>
      - Instead of the constructor of the <code>Emailer</code> creating its own <code>SpellChecker</code>, we can add a method that <i>accepts</i> a <code>SpellChecker</code>.
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/eebbd96e096960d8ef94a39aef5b12d4.js"></script>
        </div>
      </div>
      - This allows us to substitute the <code>SpellChecker</code> with a version of our own, and thus we can use the <code>MockSpellChecker</code> that we created above to
      now test the functionality of the <code>Emailer</code> class. Similarly, we can also substitute the <code>SpellChecker</code> with another spell checker easily now.
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/5433736deef30f1c06ea70be32b53f5a.js"></script>
        </div>
      </div>
      - In the above example, we are setting the <code>SpellChecker</code> manually. At the time of construction of the <code>Emailer</code> class, we are manually setting the
      dependency. Hence, this is also sometimes referred to as <i>construction by hand</i>. <br>
      - The above code was an example of <i>setter injection</i>. You can also do a <i>constructor injection</i> by passing in the dependency during the construction of the
      <code>Emailer</code> class itself. The advantage of following this approach is that it makes the dependency between the two classes explicit. You cannot create an
      <code>Emailer</code> class without creating a <code>SpellChecker</code> class. And thus it reduces the chances of someone forgetting to set the dependency on the object.
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/61dd10e33ac604bb15728f8590b1e356.js"></script>
        </div>
      </div>

      <p class="inline-heading">Problems with construction-by-hand</p>:
      The problem with this technique is that the burden of knowing how to create the object graph is placed on the client of the service. In this case, it is the
      <code>Emailer</code> class that must set up its dependency, <code>SpellChecker</code>, either through constructor or through setter injection. Also, if the same object is
      being
      used in multiple places, then you need to repeat the code of wiring together the object in all the places. If you decide to change the dependency graph in the future, you
      will have to go to all the places and make the change yourself. <br>
      - Another problem is the fact that users need to know how object graphs are wired internally. This violates the principle of encapsulation and becomes problematic when
      dealing with code that is used by many clients, who really shouldn't have to care about the internals of their dependencies in order to use them.
    </div>


    <div class="sub-heading">Factory Pattern</div>
    <div>
      - One way of getting around the problem of having to construct the objects in an object graph yourself is to use a Factory Pattern.
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/6d175592d5dcb92296c26debe810c19c.js"></script>
        </div>
      </div>
      - The most important thing to notice here is that the client code has no reference to spellchecking, address books, or any of the other internals of <code>Emailer</code>.
      By adding a level of abstraction (the Factory pattern), we have separated the code using the <code>Emailer</code> from the code that creates the <code>Emailer</code>. This
      leaves client code clean and concise. This becomes even more useful when the object graph of the created object is even more complex.
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/0e2ee1d113d17abdf6b279edd180fc17.js"></script>
        </div>
      </div>
      - Talking about testing, the <code>Emailer</code> code is still using the same constructor injection it was using previously. So we can still test the <code>Emailer</code>
      class as we were previously. <br>

      <p class="inline-heading">Problems with using Factory Pattern</p>:
      Testing the internals of the object returned from the factory becomes difficult unless the factory has explicitly provided capabilities to test it. What do I mean by that?
      This client does not know anything about <code>Emailer</code>'s internals; instead, it depends on a Factory. In one of the previous scenarios, we were able to swap out the
      <code>SpellChecker</code> being injected into the class with a <code>MockSpellChecker</code> of our own. But that will not be possible in this case. <br>
      - Another issue is that if you are going with Factory Pattern then you will have to create a new method for <i>every</i> variation of <i>every</i> service. That is a lot of
      code to test and maintain. If you decided that you wanted to replace the <code>AddressBook</code> with <code>PhoneAndAddressBook</code>, you will have to go through all the
      methods in the factory and make the substitution. Plus there might be many dependencies that are common across different types of <i>Emailer</i> objects but which you still
      have to specify separately for each new method that you add to the factory. One way to get around this is to use a 'general' factory that first creates a common version of
      the object and then use that intermediate object to set any specific fields on it. But this again leads to code that is difficult to test.
    </div>


    <div class="sub-heading">Service Locator Pattern</div>
    <div>
      - A Service Locator is also a kind of factory. The way that it works is that you pass in a <i>key</i> to the service locator, and the service locator replies with a
      fully-formed object that you can use in your code. <br>
      - This is what it would look like: <code>Emailer emailer = (Emailer) new ServiceLocator().get("Emailer");</code> <br>
      - Since all the locator needs is a key, a Service Locator acts as a factory that can return <i>any</i> kind of service. Compare this to the <i>EmailerFactory</i> class where
      it was returning only one type of object - namely <i>Emailer</i>. <br>
      - The Java Naming and Directory Interface (JNDI) is a good example of a Service Locator pattern. It is often used by application servers to register resources at start time
      and later by deployed applications to look them up. Web applications typically use JNDI to look up data sources in this manner. <br>
      - An example of gettig a different object: <code>Emailer emailer = (Emailer) new ServiceLocator().get("JapaneseEmailerWithPhoneAndEmail");</code>

      <p class="inline-heading">Problems with using Service Locator Pattern</p>:
      Being a kind of Factory, Service Locators suffer from the same problems of testability and shared state. The keys used to identify a service are opaque and
      can be confusing to work with. The practice of embedding information about the service within its identifier (namely, "JapaneseEmailerWithPhoneAndEmail") is also verbose and
      places too much emphasis on arbitrary conventions.
    </div>


    <div class="sub-heading">Embracing Dependency Injection</div>
    <div>
      - DI is a magical way that takes all the good parts of the above solutions and leaves behind all the bad parts. DI enables testability in the same way as construction
      by hand, via a setter method or constructor injection. DI removes the need for clients to know about their dependencies and how to create them, just as factories do. It
      leaves behind the problems of shared state and repetitive clutter, by moving construction responsibility to a library. <br>
      - In case of DI, the task of creating, assembling, and wiring the dependencies into an object graph is performed by an external framework known as a <i>dependency
      injection framework</i> or simply a <i>dependency injector</i>. The control over the construction, wiring, and assembly of an object graph no loger resides with the clients
      or services themselves. This is also known as the <i>Inversion of Control</i>.

      <img src="imgs/ch1/DI_Basics.png"
           class="center-block img-fluid"
           alt="EmailMessagingService"
           width="700">
    </div>

    - Notice that <i>EmailClient</i> knows nothing about what kind of <i>Emailer</i> it needs or is using to send a message. All it knows is that it accepts <i>some kind</i> of
    <i>Emailer</i>, and this dependency is used when needed. Also notice that the client code is now starting to resemble service code; both are free of logic to create or locate
    dependencies. <br>
    - This highlights the separation of <i>infrastructure</i> code (meant for wiring and construction) from <i>application</i> code (the core purpose of a service).

    <div class="code-block">
      <div class="expand-code-snip-btn border border-primary rounded">
        <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
      </div>
      <div class="code-snippet">
        <script src="https://gist.github.com/rgbk21/ec25eeab502bc56ce05816aff7b0cc21.js"></script>
      </div>
    </div>

    - Footnote about Gin: Guice is also available inside the Google Web Toolkit (GWT), via its cousin Gin. Google Gin is a port of Guice for the GWT, a JavaScript web framework.
    Find out more <a href=" http://code.google.com/p/google-gin">here</a>.
  </div>

  <hr>
  <div id="Chapter2" class="chapter">Chapter 2: Time for Injection</div>
  <hr>

  <div class="textual-content">
    <div class="sub-heading">Constructing objects with dependency injection</div>
    <div>
      - The dependency injector is itself a service like any other. And like any service, it must be constructed and prepared before it can be used. Once the injector has been
      bootstrapped, we can obtain an object from it for use. <br>
      - This is an example of using Guice for injection:
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/e86b74b88b00f833425b131e3f78a3a0.js"></script>
        </div>
      </div>
      - Think of Guice as a factory class for Dependency Injectors. Note that in the above example, you are asking Guice directly for an <i>Emailer</i> class. The object graph of
      the <i>Emailer</i> class requires dependencies <i>SpellChecker</i> and <i>Dict</i>. But you don't have to worry about providing these. Guice can wire-up the fully-formed
      object for you when you request it. Also note that you had to use the <code>@Inject</code> annotation on the <i>Emailer</i> and the <i>SpellChecker</i> classes in order to
      get the code to compile properly. If you remove this annotation, from either of the classes, you get the following error: "Could not find a suitable constructor in
      Chapter2._1_Basics.SpellChecker. Classes must have either one (and only one) constructor annotated with @Inject or a zero-argument constructor that is not private." <br>
      - The <code>@Inject</code> annotation is supposed to tell Guice which constructor to use when creating the object, and consequently what it's dependencies are. <br>
      - In this particular line: <code>Emailer emailer = Guice.createInjector().getInstance(Emailer.class);</code> you are doing something similar to what we did in the Service
      Locator pattern, the difference being now we are using a class type to get an object as the key, instead of directly using a string. In a sense the injector is an automated,
      all-purpose service locator prepackaged for convenience.
    </div>

    <div class="sub-heading">Metadata and injector configuration</div>
    <div>
      - In essence what you did by using the <code>@Inject</code> annotation was configure the <i>injector</i> by telling it which constructor to use and hence what the
      dependencies of the object are. If you had been using Spring, you would do the same thing by using <code>@Component</code> and <code>@Autowired</code> combination. <br>
      - There are multiple ways in which you can configure the injector: <br>
      a) Using an XML Configuration File <br>
      b) Invoking into a programmatic API <br>
      c) Using an injection-oriented DSL <br>
      d) By inference; that is, implicitly from the structure of classes <br>
      e) By inference from annotated source code <br>
    </div>

    <div class="sub-heading">XML Injection in Spring</div>
    <div>
      - When using injection in Spring, we do the following (the other stuff remains common):
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/cd4caccc8345e055c4c03d10393d2a5d.js"></script>
        </div>
      </div>
      - Here, <code>BeanFactory</code> refers to the Spring dependency injector. The call to <code>getBean()</code> is analogous to the original call to <code>getInstance()</code>.
      Both return an instance of <i>Emailer</i>. The <code>FileSystemXmlApplicationContext</code> is a special type of <code>BeanFactory</code>. There are other kinds of
      application contexts available for use as well. They are mentioned on <a href="https://www.baeldung.com/spring-application-context">this link on Baeldung</a>. <br>
      - The file email.xml contains the configuration required for Spring's injector to provide us with an emailer correctly wired with its dependencies.
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/32d203ce8fc105af20bb09e6c4ef62ef.js"></script>
        </div>
      </div>
    </div>


    <div class="sub-heading">XML to in-code configuration in Guice</div>
    <div>
      - Using an XML configuration is advantageous in the sense that all the configuration can be easily seen in one place which becomes easier when you are working on a large
      project. You can do the same thing with Guice as well. In the case of Guice, you can do it in two ways. Either by implementing the <code>Module</code> interface, or by
      extending the <code>AbstractModule</code> class. <br>
      - Guice is able to automatically inject Concrete Class with either a public no argument constructor or a constructor with @Inject without any specific defined binding in your
      module but when it comes to Interfaces you have to define the necessary bindings. <a href="https://stackoverflow.com/a/24767043/8742428">Source on SO</a>. This is what the
      module class would look like with the bindings defined:
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/4a751aa7e972a90f9e16bc5adc4f128b.js"></script>
        </div>
      </div>
      - Note that the config on the main class now changes slightly. Note that we are passing in the module class that we created to the <code>createInjector</code> method. Without
      this it does not work.
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/c6de64563a10362fd45c653be092c593.js"></script>
        </div>
      </div>
      - If you were doing the same thing using the <code>AbstractModule</code>, this is what the module class would look like. And instead of passing in the
      <code>new EmailModule()</code> as you did above, you would now be passing in <code>new EmailAbstractModule()</code>.
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/579b34d53bbd72572650f977f1d3ff92.js"></script>
        </div>
      </div>
    </div>

    <div class="sub-heading">Revisiting Spring and autowiring</div>
    <div>
      - You can use autowire in the config files to configure the Spring injections as well. The config file in that case will look like this. But note that Intellij does not like
      this and tries to revert to the method above, ie. make the constructor injection explicit.
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/f5c015df851d377dad20fca44f12e184.js"></script>
        </div>
      </div>
      - Of course, you can also just entirely ignore the XML configuration, and go directly with annotations. In the setup that you are using, you still included the xml file as
      well.
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/2fb23c6b05b2844647cfda9551688488.js"></script>
        </div>
      </div>
      - And the context that we are using to get the beans from is defined as follows:
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/fd9c66d9a2c10e213fbd05b70bb5ceb4.js"></script>
        </div>
      </div>
      - Note that now we have to use the <code>ClassPathXmlApplicationContext</code>, instead of the <code>FileSystemXmlApplicationContext</code> that we used previously above.
      Note that you also had to add this in Facets in Intellij, because it was giving you a warning. Note the folder structure as well. The reason for highlighting the folder
      structure is so that you can notice the usage of class path related stuff. See how paths are being used in
      <code>new ClassPathXmlApplicationContext("email-actual-autowire-config.xml")</code> and <code>&lt;context:component-scan base-package="_1_Basics"/&gt;</code> and relate it to
      the folder structure being used.
      <img src="imgs/ch2/SpringFacets.PNG"
           class="center-block img-fluid"
           alt="SpringFacets"
           width="1919">
      - The three application contexts that were introduced above can be seen here:
      <img src="imgs/ch2/ApplicationContexts.PNG"
           class="center-block img-fluid"
           alt="SpringFacets"
           width="1920">
    </div>

    <div class="sub-heading">Identifying dependencies for injection</div>
    <div>
      - A <i>flat object</i> is an object that has no dependencies of its own. <br>
      - In the Guice example that we saw above, there is a single implementation of the <i>EmailerIF</i> that we are using to inject in as a dependency, namely the <i>Emailer</i>
      class. But we might have multiple implemnetations of the same interface and we may want to conditionally inject different implementations depending on our requirements. For
      example, on the right side, we have two implementations of the <i>EmailerIF</i>, <i>Emailer</i> and <i>AdvancedEmailer</i>. So when we create an <i>EmailClient</i>, we might
      might want to choose either of the implementations, <i>Emailer</i> or <i>AdvancedEmailer</i>. So how do you tell your injector which of these two dependencies you want to
      use? This is the question we will be trying to answer here.
      <img src="imgs/ch2/DependencyGraph.png"
           class="center-block img-fluid"
           alt="SpringFacets"
           width="2288">
    </div>

    <div class="sub-heading">Identifying by String keys</div>
    <div>
      - Suppose that we are using Spring, and we are trying to create the following dependency graph. <i>Emailer</i> requires a <i>SpellChecker</i>, and there are two possible
      implementations of it - <i>EnglishSpellChecker</i> and <i>FrenchSpellChecker</i>.
      <img src="imgs/ch2/DependencyGraph-MultipleSpellCheckers.png"
           class="center-block img-fluid"
           alt="SpringFacets"
           width="650">
      - Then depending on the type of <i>Emailer</i> that we are trying to create, we can configure the xml as follows:
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/9afb7a7196facbfb28a31e4def5f26f5.js"></script>
        </div>
      </div>
      - And we create instances of the <i>Emailer</i> as follows: and this will give us a fully-formed french emailer.
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/56ccc5aab5595ffe13c9be564c054a65.js"></script>
        </div>
      </div>

      <p class="inline-heading">Drawbacks of this method</p>: <br>
      a) A misspelled key that maps to no valid service can be difficult to detect until well into the runtime of the program. If you are working with a statically typed language
      like Java, this is a poor sacrifice to have to make. These languages are supposed to offer guarantees around type validity at compile time. Ideally, one should not have to
      wait until runtime to detect problems in key bindings. Intellij does not warn you about these kinds of errors, and they appear only during runtime. <br>
      b) In your injector configuration there is no way to determine the type of a binding if all you have is a string key. Without starting up the injector and inspecting the
      specific instance for a key, it is hard to determine what type the key is bound to. But do note that Intellij does provide you with some level of static checking in order to
      minimize this kind of issue. For example suppose you passed in an incorrect class <i>Dict_2</i> instead of <i>Dict</i>, Intellij would give you a compile error.
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/9b1177e703fd32ab7c59ccb9267dc39a.js"></script>
        </div>
      </div>
    </div>


    <div class="sub-heading">Identifying by type</div>
    <div>
      - Since Guice configuration file requires you to explicitly specify the class that you are going to inject, the compile time checking of the classes being injected can be
      done in Guice configuration as well (just like Spring). This takes care of the point 2 of the drawback we discussed above. Also since there is no name in the form of String
      being associated with the dependency, there is no scope of mistyping the name and getting a run time error either. This takes care of the point 1 of the drawback. <br>
      - All the stuff with the XML configuration that we did in the above section using Spring, we can also do using simple annotations. We make use of the
      <code>@Configuration</code> and <code>@Bean</code> annotations for this. The objective is still the same - pass in different implementations of the <i>SpellChecker</i> class
      for the specific implementations for the <i>Emailer</i>. But this time without using XML.
      - First we need to define a configuration class that would be equivalent to defining the XML file in the previous approach. The <code>@Configuration</code> annotation
      indicates that the class can be used by the Spring IoC container as a source of bean definitions. It indicates that a class declares one or more <code>@Bean</code> methods
      and may be processed by the Spring container to generate bean definitions and service requests for those beans at runtime. <br>
      - The <code>@Bean</code> annotation tells Spring that a method annotated with <code>@Bean</code> will return an object that should be registered as a bean in the Spring
      application context. See <a href="https://www.tutorialspoint.com/spring/spring_java_based_configuration.htm">this link on Tutorials Point for a good explanation</a>.
      We aren't doing anything special, all we have done is convert the XML bindings into code.

      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/25754a5e019d116afd77c350b9dd177c.js"></script>
        </div>
      </div>

      - And then we can use these beans as follows. We need to register and refresh the context for <a
      href="https://stackoverflow.com/questions/28404817/annotationconfigapplicationcontext-has-not-been-refreshed-yet-whats-wrong">this reason explained on SO</a>. <br>
      - If you had just a single object of a particular type, you could have fetched the object using the type of the object, as we are doing with the <i>EnglishSpellChecker</i> in
      the below example. For other cases, you would have to fall back to using the String keys instead.
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/15819463dcb790c67fdf08d33efd09f9.js"></script>
        </div>
      </div>

      <p class="inline-heading">Drawbacks of this method</p>: <br>
      a) Like we saw, if we use types, we cannot distinguish between different implementations of the same service.
    </div>


    <div class="sub-heading">Combinatorial Keys</div>
    <div>
      - Ideally we want something like this: <i>[Emailer.class, "english"]</i>. The type key identifies the service that dependents rely on, in a safe and consistent manner. Its
      counterpart, the string key, identifies the specific variant that the key is bound to but does so in an abstract manner. However, the String part of the key is still
      susceptible to typos and errors that we saw previously. We get around this issue by using an annotation in place of a String. <br>
      - Guice<sup>TM</sup> embodies the use of type/annotation combinatorial keys and was probably the first library to use this strategy. <br>
      - Suppose this is the object graph that we are going to create. As we can see in the diagram, <i>FrenchEmailer</i> and <i>EnglishEmailer</i> both require the dependency
      <i>SpellChecker</i>. But there are two different implementations available: <i>FrenchSpellChecker</i> and <i>EnglishSpellChecker</i>. We want the <i>EnglishSpellChecker</i>
      to be injected into the <i>EnglishEmailer</i> class and the <i>FrenchSpellChecker</i> into the <i>FrenchEmailer</i> class. <br>
      - The way we are going to do this is through the use of annotations. At the point where we are injecting <i>SpellChecker</i> type into the <i>EnglishEmailer</i> for eg., we
      will annotate that injection with a custom annotation <code>@English</code> that we have created. Then we are going to tell Guice that - hey, whenever you see a dependency
      that requires the <i>SpellChecker</i> object, and has been annotated with <i>@English</i>, you should inject the <i>EnglishSpellChecker</i> exclusively. In the same manner,
      we are going to do for the french side as well.
      <img src="imgs/ch2/Emailer_Guice_Annotations.png"
           class="center-block img-fluid"
           alt="SpringFacets"
           width="1764">


      Step 1) We create custom annotations that we are going to make use of.
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/ec3f8c09cbfcbf1e971dd54d58c1793a.js"></script>
        </div>
      </div>

      Step 2) Annotate the injections with the respective annotations:
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/c9c8382e8f51029c271ea6b7e548b010.js"></script>
        </div>
      </div>

      Step 3) Tell Guice to inject the dependencies based off of the annotation that we are using:
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/63f146607e32c890047a33813184e62f.js"></script>
        </div>
      </div>

      Step 4) Get the object that you are interested in from the injector and makes use as required:
      <div class="code-block">
        <div class="expand-code-snip-btn border border-primary rounded">
          <span class="btn btn-link">Expand Gist <img src="imgs/chevron-expand.svg" alt="Expand Code Snippet"></span>
        </div>
        <div class="code-snippet">
          <script src="https://gist.github.com/rgbk21/b6a32fe74f1f6e7917822ccc4e57dec7.js"></script>
        </div>
      </div>

      - This might strike you as odd - while the <i>EnglishEmailer</i> does not depend directly on a specific implementation, it seems to couple via the use of
      <code>@English</code> annotation. Doesn't this mean <i>EnglishEmailer</i> is tightly coupled to English spellcheckers? The answer is a surprising no. To understand why,
      consider the following altered injector configuration: <code>bind(SpellChecker.class).annotatedWith(English.class).to(FrenchSpellChecker.class);</code>. Here, we've changed
      the service implementation bound to the combinatorial key <i>[SpellChecker.class, English.class]</i> so that any dependent referring to an <i>@English</i> annotated
      <i>SpellChecker</i> will actually receive an implementation of type <i>FrenchSpellChecker</i>. There are no errors, and <i>EnglishEmailer</i> is unaware of
      any change and more importantly <i>unaffected</i> by any change. No client code needs to change, and we were able to alter configuration transparently. So they aren't really
      tightly coupled.
    </div>
  </div>


  <hr>
  <div id="Chapter3" class="chapter">Chapter 3: Investigating DI</div>
  <hr>

  <div class="textual-content">
    <div class="sub-heading">Constructing objects with dependency injection</div>
    <div>
      -
    </div>
  </div>


</div>


<script src="../../script.js"></script>
</body>
</html>